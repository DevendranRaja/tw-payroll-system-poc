/*
 * MIT License
 *
 * Copyright (c) 2019 RÃ©mi Van Keisbelck
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
import { Tuple } from './Tuple';
import { maybeOf } from './Maybe';
export class Dict {
    constructor(d) {
        this.d = d;
    }
    static empty() {
        return new Dict({});
    }
    static fromList(entries) {
        const newD = {};
        entries.forEach((e) => {
            newD[e.a] = e.b;
        });
        return new Dict(newD);
    }
    put(key, value) {
        const newD = Object.assign({}, this.d);
        newD[key] = value;
        return new Dict(newD);
    }
    get(key) {
        return maybeOf(this.d[key]);
    }
    exists(key) {
        return this.d[key] !== undefined;
    }
    remove(key) {
        if (this.d[key]) {
            const newD = Object.assign({}, this.d);
            delete newD[key];
            return new Dict(newD);
        }
        return this;
    }
    keys() {
        return Object.keys(this.d);
    }
    size() {
        return this.keys().length;
    }
    isEmpty() {
        return this.size() === 0;
    }
    toList() {
        return this.keys().map((k) => new Tuple(k, this.d[k]));
    }
    filter(f) {
        return Dict.fromList(this.toList().filter(f));
    }
    update(key, f) {
        return f(this.get(key))
            .map((value) => this.put(key, value))
            .withDefaultSupply(() => this.remove(key));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGljdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9UZWFDdXAvRGljdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0F1Qkc7QUFFSCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQ2hDLE9BQU8sRUFBUyxPQUFPLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFFekMsTUFBTSxPQUFPLElBQUk7SUFHZixZQUFvQixDQUFxQjtRQUN2QyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNiLENBQUM7SUFFRCxNQUFNLENBQUMsS0FBSztRQUNWLE9BQU8sSUFBSSxJQUFJLENBQUksRUFBRSxDQUFDLENBQUM7SUFDekIsQ0FBQztJQUVELE1BQU0sQ0FBQyxRQUFRLENBQUksT0FBb0M7UUFDckQsTUFBTSxJQUFJLEdBQXdCLEVBQUUsQ0FBQztRQUNyQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7WUFDcEIsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xCLENBQUMsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxJQUFJLElBQUksQ0FBSSxJQUFJLENBQUMsQ0FBQztJQUMzQixDQUFDO0lBRUQsR0FBRyxDQUFDLEdBQVcsRUFBRSxLQUFRO1FBQ3ZCLE1BQU0sSUFBSSxxQkFBUSxJQUFJLENBQUMsQ0FBQyxDQUFFLENBQUM7UUFDM0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUNsQixPQUFPLElBQUksSUFBSSxDQUFJLElBQUksQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUFFRCxHQUFHLENBQUMsR0FBVztRQUNiLE9BQU8sT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUM5QixDQUFDO0lBRUQsTUFBTSxDQUFDLEdBQVc7UUFDaEIsT0FBTyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLFNBQVMsQ0FBQztJQUNuQyxDQUFDO0lBRUQsTUFBTSxDQUFDLEdBQVc7UUFDaEIsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDaEIsTUFBTSxJQUFJLHFCQUFRLElBQUksQ0FBQyxDQUFDLENBQUUsQ0FBQztZQUMzQixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNqQixPQUFPLElBQUksSUFBSSxDQUFJLElBQUksQ0FBQyxDQUFDO1FBQzNCLENBQUM7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFRCxJQUFJO1FBQ0YsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3QixDQUFDO0lBRUQsSUFBSTtRQUNGLE9BQU8sSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLE1BQU0sQ0FBQztJQUM1QixDQUFDO0lBRUQsT0FBTztRQUNMLE9BQU8sSUFBSSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztJQUMzQixDQUFDO0lBRUQsTUFBTTtRQUNKLE9BQU8sSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxLQUFLLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3pELENBQUM7SUFFRCxNQUFNLENBQUMsQ0FBbUM7UUFDeEMsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBRUQsTUFBTSxDQUFDLEdBQVcsRUFBRSxDQUE0QjtRQUM5QyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQ3BCLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7YUFDcEMsaUJBQWlCLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQy9DLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBNSVQgTGljZW5zZVxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxOSBSw6ltaSBWYW4gS2Vpc2JlbGNrXG4gKlxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICpcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXG4gKiBTT0ZUV0FSRS5cbiAqXG4gKi9cblxuaW1wb3J0IHsgVHVwbGUgfSBmcm9tICcuL1R1cGxlJztcbmltcG9ydCB7IE1heWJlLCBtYXliZU9mIH0gZnJvbSAnLi9NYXliZSc7XG5cbmV4cG9ydCBjbGFzcyBEaWN0PFQ+IHtcbiAgcHJpdmF0ZSByZWFkb25seSBkOiB7IFtpZDogc3RyaW5nXTogVCB9O1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoZDogeyBbcDogc3RyaW5nXTogVCB9KSB7XG4gICAgdGhpcy5kID0gZDtcbiAgfVxuXG4gIHN0YXRpYyBlbXB0eTxUPigpOiBEaWN0PFQ+IHtcbiAgICByZXR1cm4gbmV3IERpY3Q8VD4oe30pO1xuICB9XG5cbiAgc3RhdGljIGZyb21MaXN0PFQ+KGVudHJpZXM6IHJlYWRvbmx5IFR1cGxlPHN0cmluZywgVD5bXSk6IERpY3Q8VD4ge1xuICAgIGNvbnN0IG5ld0Q6IHsgW2lkOiBzdHJpbmddOiBUIH0gPSB7fTtcbiAgICBlbnRyaWVzLmZvckVhY2goKGUpID0+IHtcbiAgICAgIG5ld0RbZS5hXSA9IGUuYjtcbiAgICB9KTtcbiAgICByZXR1cm4gbmV3IERpY3Q8VD4obmV3RCk7XG4gIH1cblxuICBwdXQoa2V5OiBzdHJpbmcsIHZhbHVlOiBUKTogRGljdDxUPiB7XG4gICAgY29uc3QgbmV3RCA9IHsgLi4udGhpcy5kIH07XG4gICAgbmV3RFtrZXldID0gdmFsdWU7XG4gICAgcmV0dXJuIG5ldyBEaWN0PFQ+KG5ld0QpO1xuICB9XG5cbiAgZ2V0KGtleTogc3RyaW5nKTogTWF5YmU8VD4ge1xuICAgIHJldHVybiBtYXliZU9mKHRoaXMuZFtrZXldKTtcbiAgfVxuXG4gIGV4aXN0cyhrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmRba2V5XSAhPT0gdW5kZWZpbmVkO1xuICB9XG5cbiAgcmVtb3ZlKGtleTogc3RyaW5nKTogRGljdDxUPiB7XG4gICAgaWYgKHRoaXMuZFtrZXldKSB7XG4gICAgICBjb25zdCBuZXdEID0geyAuLi50aGlzLmQgfTtcbiAgICAgIGRlbGV0ZSBuZXdEW2tleV07XG4gICAgICByZXR1cm4gbmV3IERpY3Q8VD4obmV3RCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAga2V5cygpOiByZWFkb25seSBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuZCk7XG4gIH1cblxuICBzaXplKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMua2V5cygpLmxlbmd0aDtcbiAgfVxuXG4gIGlzRW1wdHkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuc2l6ZSgpID09PSAwO1xuICB9XG5cbiAgdG9MaXN0KCk6IHJlYWRvbmx5IFR1cGxlPHN0cmluZywgVD5bXSB7XG4gICAgcmV0dXJuIHRoaXMua2V5cygpLm1hcCgoaykgPT4gbmV3IFR1cGxlKGssIHRoaXMuZFtrXSkpO1xuICB9XG5cbiAgZmlsdGVyKGY6ICh0OiBUdXBsZTxzdHJpbmcsIFQ+KSA9PiBib29sZWFuKTogRGljdDxUPiB7XG4gICAgcmV0dXJuIERpY3QuZnJvbUxpc3QodGhpcy50b0xpc3QoKS5maWx0ZXIoZikpO1xuICB9XG5cbiAgdXBkYXRlKGtleTogc3RyaW5nLCBmOiAodjogTWF5YmU8VD4pID0+IE1heWJlPFQ+KTogRGljdDxUPiB7XG4gICAgcmV0dXJuIGYodGhpcy5nZXQoa2V5KSlcbiAgICAgIC5tYXAoKHZhbHVlKSA9PiB0aGlzLnB1dChrZXksIHZhbHVlKSlcbiAgICAgIC53aXRoRGVmYXVsdFN1cHBseSgoKSA9PiB0aGlzLnJlbW92ZShrZXkpKTtcbiAgfVxufVxuIl19