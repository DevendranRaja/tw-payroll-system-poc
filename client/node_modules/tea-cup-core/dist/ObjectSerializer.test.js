/*
 * MIT License
 *
 * Copyright (c) 2019 RÃ©mi Van Keisbelck
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
import { ObjectSerializer } from './ObjectSerializer';
import { expect, test } from "vitest";
class Customer {
    constructor(name, birthDate, address, orders) {
        this.optionalStuff = undefined;
        this.anyThing = { yolo: true };
        this.name = name;
        this.address = address;
        this.orders = orders;
        this.birthDate = birthDate;
    }
    hasTooManyOrders() {
        return this.orders.length > 2;
    }
    livesInNice() {
        var _a;
        return ((_a = this.address) === null || _a === void 0 ? void 0 : _a.isInNice()) === true;
    }
}
class Address {
    constructor(street, city) {
        this.street = street;
        this.city = city;
    }
    isInNice() {
        return this.city === 'nice';
    }
}
class Order {
    constructor(product, price) {
        this.product = product;
        this.price = price;
    }
    isExpensive() {
        return this.price > 250;
    }
}
const birthDate = new Date(Date.parse('2019-01-01T00:00:00.000Z'));
const customer = new Customer('John', birthDate, new Address('rue du quai', 'marseille'), [
    new Order('Gode', 300),
    new Order('React for dummies', 10),
    new Order('Tea', 100),
]);
test('roundtrip customer', () => {
    var _a, _b;
    const s = ObjectSerializer.withClasses([Customer, Address, Order]);
    const str = s.serialize(customer);
    const c = s.deserialize(str);
    expect(c.name).toBe('John');
    expect(c.birthDate.toISOString()).toBe(birthDate.toISOString());
    expect(c.hasTooManyOrders()).toBe(true);
    expect(c.livesInNice()).toBe(false);
    expect((_a = c.address) === null || _a === void 0 ? void 0 : _a.street).toBe('rue du quai');
    expect((_b = c.address) === null || _b === void 0 ? void 0 : _b.city).toBe('marseille');
    expect(c.orders[0].isExpensive()).toBe(true);
    expect(c.orders[0].product).toBe('Gode');
    expect(c.orders[1].isExpensive()).toBe(false);
    expect(c.optionalStuff).toBeUndefined();
    expect(c.anyThing.yolo).toBe(true);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiT2JqZWN0U2VyaWFsaXplci50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL1RlYUN1cC9PYmplY3RTZXJpYWxpemVyLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBdUJHO0FBRUgsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDdEQsT0FBTyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFFdEMsTUFBTSxRQUFRO0lBUVosWUFBWSxJQUFZLEVBQUUsU0FBZSxFQUFFLE9BQWdCLEVBQUUsTUFBZTtRQUpuRSxrQkFBYSxHQUFZLFNBQVMsQ0FBQztRQUVuQyxhQUFRLEdBQVEsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUM7UUFHdEMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7UUFDdkIsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7SUFDN0IsQ0FBQztJQUVELGdCQUFnQjtRQUNkLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFRCxXQUFXOztRQUNULE9BQU8sQ0FBQSxNQUFBLElBQUksQ0FBQyxPQUFPLDBDQUFFLFFBQVEsRUFBRSxNQUFLLElBQUksQ0FBQztJQUMzQyxDQUFDO0NBQ0Y7QUFFRCxNQUFNLE9BQU87SUFJWCxZQUFZLE1BQWMsRUFBRSxJQUFZO1FBQ3RDLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ25CLENBQUM7SUFFRCxRQUFRO1FBQ04sT0FBTyxJQUFJLENBQUMsSUFBSSxLQUFLLE1BQU0sQ0FBQztJQUM5QixDQUFDO0NBQ0Y7QUFFRCxNQUFNLEtBQUs7SUFJVCxZQUFZLE9BQWUsRUFBRSxLQUFhO1FBQ3hDLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO0lBQ3JCLENBQUM7SUFFRCxXQUFXO1FBQ1QsT0FBTyxJQUFJLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQztJQUMxQixDQUFDO0NBQ0Y7QUFFRCxNQUFNLFNBQVMsR0FBUyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLDBCQUEwQixDQUFDLENBQUMsQ0FBQztBQUV6RSxNQUFNLFFBQVEsR0FBYSxJQUFJLFFBQVEsQ0FBQyxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksT0FBTyxDQUFDLGFBQWEsRUFBRSxXQUFXLENBQUMsRUFBRTtJQUNsRyxJQUFJLEtBQUssQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDO0lBQ3RCLElBQUksS0FBSyxDQUFDLG1CQUFtQixFQUFFLEVBQUUsQ0FBQztJQUNsQyxJQUFJLEtBQUssQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDO0NBQ3RCLENBQUMsQ0FBQztBQUVILElBQUksQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7O0lBQzlCLE1BQU0sQ0FBQyxHQUFxQixnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDckYsTUFBTSxHQUFHLEdBQVcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUMxQyxNQUFNLENBQUMsR0FBYSxDQUFDLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBYSxDQUFDO0lBQ25ELE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzVCLE1BQU0sQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDO0lBQ2hFLE1BQU0sQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN4QyxNQUFNLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxNQUFBLENBQUMsQ0FBQyxPQUFPLDBDQUFFLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUM5QyxNQUFNLENBQUMsTUFBQSxDQUFDLENBQUMsT0FBTywwQ0FBRSxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDMUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDN0MsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3pDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzlDLE1BQU0sQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDeEMsTUFBTSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3JDLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIE1JVCBMaWNlbnNlXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE5IFLDqW1pIFZhbiBLZWlzYmVsY2tcbiAqXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gKlxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICpcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcbiAqIFNPRlRXQVJFLlxuICpcbiAqL1xuXG5pbXBvcnQgeyBPYmplY3RTZXJpYWxpemVyIH0gZnJvbSAnLi9PYmplY3RTZXJpYWxpemVyJztcbmltcG9ydCB7IGV4cGVjdCwgdGVzdCB9IGZyb20gXCJ2aXRlc3RcIjtcblxuY2xhc3MgQ3VzdG9tZXIge1xuICByZWFkb25seSBuYW1lOiBzdHJpbmc7XG4gIHJlYWRvbmx5IGFkZHJlc3M/OiBBZGRyZXNzO1xuICByZWFkb25seSBvcmRlcnM6IE9yZGVyW107XG4gIHJlYWRvbmx5IG9wdGlvbmFsU3R1ZmY/OiBzdHJpbmcgPSB1bmRlZmluZWQ7XG4gIHJlYWRvbmx5IGJpcnRoRGF0ZTogRGF0ZTtcbiAgcmVhZG9ubHkgYW55VGhpbmc6IGFueSA9IHsgeW9sbzogdHJ1ZSB9O1xuXG4gIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgYmlydGhEYXRlOiBEYXRlLCBhZGRyZXNzOiBBZGRyZXNzLCBvcmRlcnM6IE9yZGVyW10pIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMuYWRkcmVzcyA9IGFkZHJlc3M7XG4gICAgdGhpcy5vcmRlcnMgPSBvcmRlcnM7XG4gICAgdGhpcy5iaXJ0aERhdGUgPSBiaXJ0aERhdGU7XG4gIH1cblxuICBoYXNUb29NYW55T3JkZXJzKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLm9yZGVycy5sZW5ndGggPiAyO1xuICB9XG5cbiAgbGl2ZXNJbk5pY2UoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuYWRkcmVzcz8uaXNJbk5pY2UoKSA9PT0gdHJ1ZTtcbiAgfVxufVxuXG5jbGFzcyBBZGRyZXNzIHtcbiAgcmVhZG9ubHkgc3RyZWV0OiBzdHJpbmc7XG4gIHJlYWRvbmx5IGNpdHk6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihzdHJlZXQ6IHN0cmluZywgY2l0eTogc3RyaW5nKSB7XG4gICAgdGhpcy5zdHJlZXQgPSBzdHJlZXQ7XG4gICAgdGhpcy5jaXR5ID0gY2l0eTtcbiAgfVxuXG4gIGlzSW5OaWNlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmNpdHkgPT09ICduaWNlJztcbiAgfVxufVxuXG5jbGFzcyBPcmRlciB7XG4gIHJlYWRvbmx5IHByb2R1Y3Q6IHN0cmluZztcbiAgcmVhZG9ubHkgcHJpY2U6IG51bWJlcjtcblxuICBjb25zdHJ1Y3Rvcihwcm9kdWN0OiBzdHJpbmcsIHByaWNlOiBudW1iZXIpIHtcbiAgICB0aGlzLnByb2R1Y3QgPSBwcm9kdWN0O1xuICAgIHRoaXMucHJpY2UgPSBwcmljZTtcbiAgfVxuXG4gIGlzRXhwZW5zaXZlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnByaWNlID4gMjUwO1xuICB9XG59XG5cbmNvbnN0IGJpcnRoRGF0ZTogRGF0ZSA9IG5ldyBEYXRlKERhdGUucGFyc2UoJzIwMTktMDEtMDFUMDA6MDA6MDAuMDAwWicpKTtcblxuY29uc3QgY3VzdG9tZXI6IEN1c3RvbWVyID0gbmV3IEN1c3RvbWVyKCdKb2huJywgYmlydGhEYXRlLCBuZXcgQWRkcmVzcygncnVlIGR1IHF1YWknLCAnbWFyc2VpbGxlJyksIFtcbiAgbmV3IE9yZGVyKCdHb2RlJywgMzAwKSxcbiAgbmV3IE9yZGVyKCdSZWFjdCBmb3IgZHVtbWllcycsIDEwKSxcbiAgbmV3IE9yZGVyKCdUZWEnLCAxMDApLFxuXSk7XG5cbnRlc3QoJ3JvdW5kdHJpcCBjdXN0b21lcicsICgpID0+IHtcbiAgY29uc3QgczogT2JqZWN0U2VyaWFsaXplciA9IE9iamVjdFNlcmlhbGl6ZXIud2l0aENsYXNzZXMoW0N1c3RvbWVyLCBBZGRyZXNzLCBPcmRlcl0pO1xuICBjb25zdCBzdHI6IHN0cmluZyA9IHMuc2VyaWFsaXplKGN1c3RvbWVyKTtcbiAgY29uc3QgYzogQ3VzdG9tZXIgPSBzLmRlc2VyaWFsaXplKHN0cikgYXMgQ3VzdG9tZXI7XG4gIGV4cGVjdChjLm5hbWUpLnRvQmUoJ0pvaG4nKTtcbiAgZXhwZWN0KGMuYmlydGhEYXRlLnRvSVNPU3RyaW5nKCkpLnRvQmUoYmlydGhEYXRlLnRvSVNPU3RyaW5nKCkpO1xuICBleHBlY3QoYy5oYXNUb29NYW55T3JkZXJzKCkpLnRvQmUodHJ1ZSk7XG4gIGV4cGVjdChjLmxpdmVzSW5OaWNlKCkpLnRvQmUoZmFsc2UpO1xuICBleHBlY3QoYy5hZGRyZXNzPy5zdHJlZXQpLnRvQmUoJ3J1ZSBkdSBxdWFpJyk7XG4gIGV4cGVjdChjLmFkZHJlc3M/LmNpdHkpLnRvQmUoJ21hcnNlaWxsZScpO1xuICBleHBlY3QoYy5vcmRlcnNbMF0uaXNFeHBlbnNpdmUoKSkudG9CZSh0cnVlKTtcbiAgZXhwZWN0KGMub3JkZXJzWzBdLnByb2R1Y3QpLnRvQmUoJ0dvZGUnKTtcbiAgZXhwZWN0KGMub3JkZXJzWzFdLmlzRXhwZW5zaXZlKCkpLnRvQmUoZmFsc2UpO1xuICBleHBlY3QoYy5vcHRpb25hbFN0dWZmKS50b0JlVW5kZWZpbmVkKCk7XG4gIGV4cGVjdChjLmFueVRoaW5nLnlvbG8pLnRvQmUodHJ1ZSk7XG59KTtcbiJdfQ==