/*
 * MIT License
 *
 * Copyright (c) 2019 RÃ©mi Van Keisbelck
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
/**
 * Base class for Commands.
 */
export class Cmd {
    /**
     * Create a command that does nothing
     */
    static none() {
        return new CmdNone();
    }
    /**
     * Batches passed commands into a single command.
     * @param cmds the commands to batch
     */
    static batch(cmds) {
        return new BatchCmd(cmds);
    }
    /**
     * Map this command, useful for parent-child scenarios.
     * @param mapper
     */
    map(mapper) {
        return new CmdMapped(this, mapper);
    }
}
/**
 * A command that does nothing.
 */
// exported for perf optimisation reasons
export class CmdNone extends Cmd {
    execute(dispatch) {
        // it's a noop !
    }
}
/**
 * Utility function for transforming an object into a
 * object/Cmd.none() tuple.
 * @param t an object to be paired with a Cmd.none().
 */
export function noCmd(t) {
    return [t, Cmd.none()];
}
class CmdMapped extends Cmd {
    constructor(command, mapper) {
        super();
        this.command = command;
        this.mapper = mapper;
    }
    execute(dispatch) {
        this.command.execute((m) => {
            dispatch(this.mapper(m));
        });
    }
}
class BatchCmd extends Cmd {
    constructor(cmds) {
        super();
        this.cmds = cmds;
    }
    execute(dispatch) {
        this.cmds.forEach((cmd) => cmd.execute(dispatch));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ21kLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL1RlYUN1cC9DbWQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBdUJHO0FBSUg7O0dBRUc7QUFDSCxNQUFNLE9BQWdCLEdBQUc7SUFDdkI7O09BRUc7SUFDSCxNQUFNLENBQUMsSUFBSTtRQUNULE9BQU8sSUFBSSxPQUFPLEVBQUUsQ0FBQztJQUN2QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsTUFBTSxDQUFDLEtBQUssQ0FBTSxJQUE2QjtRQUM3QyxPQUFPLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFTRDs7O09BR0c7SUFDSCxHQUFHLENBQVksTUFBNkI7UUFDMUMsT0FBTyxJQUFJLFNBQVMsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDckMsQ0FBQztDQUNGO0FBRUQ7O0dBRUc7QUFDSCx5Q0FBeUM7QUFDekMsTUFBTSxPQUFPLE9BQWEsU0FBUSxHQUFRO0lBQ3hDLE9BQU8sQ0FBQyxRQUF5QjtRQUMvQixnQkFBZ0I7SUFDbEIsQ0FBQztDQUNGO0FBRUQ7Ozs7R0FJRztBQUNILE1BQU0sVUFBVSxLQUFLLENBQVMsQ0FBSTtJQUNoQyxPQUFPLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBQ3pCLENBQUM7QUFFRCxNQUFNLFNBQTBCLFNBQVEsR0FBYztJQUlwRCxZQUFZLE9BQWlCLEVBQUUsTUFBK0I7UUFDNUQsS0FBSyxFQUFFLENBQUM7UUFDUixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN2QixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztJQUN2QixDQUFDO0lBRUQsT0FBTyxDQUFDLFFBQStCO1FBQ3JDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBTSxFQUFFLEVBQUU7WUFDOUIsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMzQixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRjtBQUVELE1BQU0sUUFBYyxTQUFRLEdBQVE7SUFHbEMsWUFBWSxJQUE2QjtRQUN2QyxLQUFLLEVBQUUsQ0FBQztRQUNSLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ25CLENBQUM7SUFFRCxPQUFPLENBQUMsUUFBeUI7UUFDL0IsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztJQUNwRCxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogTUlUIExpY2Vuc2VcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTkgUsOpbWkgVmFuIEtlaXNiZWxja1xuICpcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKlxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxuICogU09GVFdBUkUuXG4gKlxuICovXG5cbmltcG9ydCB7IERpc3BhdGNoZXIgfSBmcm9tICcuL0Rpc3BhdGNoZXInO1xuXG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIENvbW1hbmRzLlxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQ21kPE1zZz4ge1xuICAvKipcbiAgICogQ3JlYXRlIGEgY29tbWFuZCB0aGF0IGRvZXMgbm90aGluZ1xuICAgKi9cbiAgc3RhdGljIG5vbmU8TXNnPigpOiBDbWQ8TXNnPiB7XG4gICAgcmV0dXJuIG5ldyBDbWROb25lKCk7XG4gIH1cblxuICAvKipcbiAgICogQmF0Y2hlcyBwYXNzZWQgY29tbWFuZHMgaW50byBhIHNpbmdsZSBjb21tYW5kLlxuICAgKiBAcGFyYW0gY21kcyB0aGUgY29tbWFuZHMgdG8gYmF0Y2hcbiAgICovXG4gIHN0YXRpYyBiYXRjaDxNc2c+KGNtZHM6IFJlYWRvbmx5QXJyYXk8Q21kPE1zZz4+KTogQ21kPE1zZz4ge1xuICAgIHJldHVybiBuZXcgQmF0Y2hDbWQoY21kcyk7XG4gIH1cblxuICAvKipcbiAgICogQ29uY3JldGUgQ29tbWFuZHMgc2hvdWxkIGltcGxlbWVudCB0aGlzIG1ldGhvZCxcbiAgICogd2hlcmUgdGhlIGFjdHVhbCBjb21tYW5kIHdvcmsgaXMgZG9uZS5cbiAgICogQHBhcmFtIGRpc3BhdGNoIHRoZSBkaXNwYXRjaGVyXG4gICAqL1xuICBhYnN0cmFjdCBleGVjdXRlKGRpc3BhdGNoOiBEaXNwYXRjaGVyPE1zZz4pOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBNYXAgdGhpcyBjb21tYW5kLCB1c2VmdWwgZm9yIHBhcmVudC1jaGlsZCBzY2VuYXJpb3MuXG4gICAqIEBwYXJhbSBtYXBwZXJcbiAgICovXG4gIG1hcDxQYXJlbnRNc2c+KG1hcHBlcjogKGM6IE1zZykgPT4gUGFyZW50TXNnKTogQ21kPFBhcmVudE1zZz4ge1xuICAgIHJldHVybiBuZXcgQ21kTWFwcGVkKHRoaXMsIG1hcHBlcik7XG4gIH1cbn1cblxuLyoqXG4gKiBBIGNvbW1hbmQgdGhhdCBkb2VzIG5vdGhpbmcuXG4gKi9cbi8vIGV4cG9ydGVkIGZvciBwZXJmIG9wdGltaXNhdGlvbiByZWFzb25zXG5leHBvcnQgY2xhc3MgQ21kTm9uZTxNc2c+IGV4dGVuZHMgQ21kPE1zZz4ge1xuICBleGVjdXRlKGRpc3BhdGNoOiBEaXNwYXRjaGVyPE1zZz4pOiB2b2lkIHtcbiAgICAvLyBpdCdzIGEgbm9vcCAhXG4gIH1cbn1cblxuLyoqXG4gKiBVdGlsaXR5IGZ1bmN0aW9uIGZvciB0cmFuc2Zvcm1pbmcgYW4gb2JqZWN0IGludG8gYVxuICogb2JqZWN0L0NtZC5ub25lKCkgdHVwbGUuXG4gKiBAcGFyYW0gdCBhbiBvYmplY3QgdG8gYmUgcGFpcmVkIHdpdGggYSBDbWQubm9uZSgpLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbm9DbWQ8VCwgTXNnPih0OiBUKTogW1QsIENtZDxNc2c+XSB7XG4gIHJldHVybiBbdCwgQ21kLm5vbmUoKV07XG59XG5cbmNsYXNzIENtZE1hcHBlZDxNc2csIFBhcmVudE1zZz4gZXh0ZW5kcyBDbWQ8UGFyZW50TXNnPiB7XG4gIHByaXZhdGUgcmVhZG9ubHkgY29tbWFuZDogQ21kPE1zZz47XG4gIHByaXZhdGUgcmVhZG9ubHkgbWFwcGVyOiAoc3ViOiBNc2cpID0+IFBhcmVudE1zZztcblxuICBjb25zdHJ1Y3Rvcihjb21tYW5kOiBDbWQ8TXNnPiwgbWFwcGVyOiAoc3ViOiBNc2cpID0+IFBhcmVudE1zZykge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5jb21tYW5kID0gY29tbWFuZDtcbiAgICB0aGlzLm1hcHBlciA9IG1hcHBlcjtcbiAgfVxuXG4gIGV4ZWN1dGUoZGlzcGF0Y2g6IERpc3BhdGNoZXI8UGFyZW50TXNnPik6IHZvaWQge1xuICAgIHRoaXMuY29tbWFuZC5leGVjdXRlKChtOiBNc2cpID0+IHtcbiAgICAgIGRpc3BhdGNoKHRoaXMubWFwcGVyKG0pKTtcbiAgICB9KTtcbiAgfVxufVxuXG5jbGFzcyBCYXRjaENtZDxNc2c+IGV4dGVuZHMgQ21kPE1zZz4ge1xuICBwcml2YXRlIHJlYWRvbmx5IGNtZHM6IFJlYWRvbmx5QXJyYXk8Q21kPE1zZz4+O1xuXG4gIGNvbnN0cnVjdG9yKGNtZHM6IFJlYWRvbmx5QXJyYXk8Q21kPE1zZz4+KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLmNtZHMgPSBjbWRzO1xuICB9XG5cbiAgZXhlY3V0ZShkaXNwYXRjaDogRGlzcGF0Y2hlcjxNc2c+KTogdm9pZCB7XG4gICAgdGhpcy5jbWRzLmZvckVhY2goKGNtZCkgPT4gY21kLmV4ZWN1dGUoZGlzcGF0Y2gpKTtcbiAgfVxufVxuIl19