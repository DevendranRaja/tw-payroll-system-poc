"use strict";
/*
 * Copyright 2018 The Diesel Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.clearPropertiesIfObject = exports.indexOfPathInParent = exports.mergeProperties = exports.moveElement = exports.moveProperty = exports.mapValueAt = exports.getValueAt = exports.deleteValueAt = exports.setValueAt = exports.parseJsonValue = exports.valueToAny = exports.valueFromAny = exports.valueType = exports.jvArray = exports.jvObject = exports.jvBool = exports.jvNumber = exports.jvString = exports.jvNull = void 0;
const tea_cup_core_1 = require("tea-cup-core");
exports.jvNull = { tag: 'jv-null' };
function jvString(value) {
    return {
        tag: 'jv-string',
        value,
    };
}
exports.jvString = jvString;
function jvNumber(value) {
    return {
        tag: 'jv-number',
        value,
    };
}
exports.jvNumber = jvNumber;
function jvBool(value) {
    return {
        tag: 'jv-boolean',
        value,
    };
}
exports.jvBool = jvBool;
function jvObject(properties = []) {
    return {
        tag: 'jv-object',
        properties,
    };
}
exports.jvObject = jvObject;
function jvArray(elems = []) {
    return {
        tag: 'jv-array',
        elems,
    };
}
exports.jvArray = jvArray;
function valueType(value) {
    switch (value.tag) {
        case 'jv-string':
            return 'string';
        case 'jv-object':
            return 'object';
        case 'jv-number':
            return 'number';
        case 'jv-null':
            return 'null';
        case 'jv-boolean':
            return 'boolean';
        case 'jv-array':
            return 'array';
    }
}
exports.valueType = valueType;
function valueFromAny(value) {
    if (value === undefined) {
        return (0, tea_cup_core_1.err)('undefined');
    }
    if (value === null) {
        return (0, tea_cup_core_1.ok)(exports.jvNull);
    }
    if (Array.isArray(value)) {
        const a = value;
        const elems = [];
        for (let i = 0; i < a.length; i++) {
            const elemValue = valueFromAny(a[i]);
            switch (elemValue.tag) {
                case 'Ok': {
                    elems.push(elemValue.value);
                    break;
                }
                case 'Err': {
                    return elemValue;
                }
            }
        }
        return (0, tea_cup_core_1.ok)({
            tag: 'jv-array',
            elems,
        });
    }
    const valueType = typeof value;
    switch (valueType) {
        case 'object':
            if (!isObjLiteral(value)) {
                return (0, tea_cup_core_1.err)('not an object literal');
            }
            const keys = Object.keys(value);
            const properties = [];
            for (let i = 0; i < keys.length; i++) {
                const propName = keys[i];
                const propValue = valueFromAny(value[propName]);
                switch (propValue.tag) {
                    case 'Ok': {
                        properties.push({
                            name: propName,
                            value: propValue.value,
                        });
                        break;
                    }
                    case 'Err': {
                        return propValue;
                    }
                }
            }
            return (0, tea_cup_core_1.ok)({ tag: 'jv-object', properties });
        case 'string':
            return (0, tea_cup_core_1.ok)({ tag: 'jv-string', value });
        case 'boolean':
            return (0, tea_cup_core_1.ok)({ tag: 'jv-boolean', value });
        case 'number':
            return (0, tea_cup_core_1.ok)({ tag: 'jv-number', value: value.toString() });
        default:
            return (0, tea_cup_core_1.err)(valueType);
    }
}
exports.valueFromAny = valueFromAny;
function valueToAny(value) {
    switch (value.tag) {
        case 'jv-array':
            return value.elems.map(valueToAny);
        case 'jv-object': {
            const res = {};
            value.properties.forEach((p) => {
                res[p.name] = valueToAny(p.value);
            });
            return res;
        }
        case 'jv-boolean':
            return value.value;
        case 'jv-null':
            return null;
        case 'jv-number':
            const parsed = parseFloat(value.value);
            return isNaN(parsed) ? value.value : parsed;
        case 'jv-string': {
            return value.value;
        }
    }
}
exports.valueToAny = valueToAny;
function isObjLiteral(_obj) {
    let _test = _obj;
    return typeof _obj !== 'object' || _obj === null
        ? false
        : (function () {
            while (true) {
                if (Object.getPrototypeOf((_test = Object.getPrototypeOf(_test))) ===
                    null) {
                    break;
                }
            }
            return Object.getPrototypeOf(_obj) === _test;
        })();
}
function parseJsonValue(json) {
    try {
        const x = JSON.parse(json);
        return valueFromAny(x);
    }
    catch (e) {
        if (e instanceof Error) {
            return (0, tea_cup_core_1.err)(e.message);
        }
        return (0, tea_cup_core_1.err)('unhandled error ' + e);
    }
}
exports.parseJsonValue = parseJsonValue;
function setValueAt(root, path, value) {
    return mapValueAt(root, path, () => (0, tea_cup_core_1.just)(value)).withDefault(root);
}
exports.setValueAt = setValueAt;
function deleteValueAt(root, path) {
    return mapValueAt(root, path, () => tea_cup_core_1.nothing);
}
exports.deleteValueAt = deleteValueAt;
function getValueAt(root, path) {
    const ph = path.head();
    switch (ph.type) {
        case 'Just': {
            const pathHead = ph.value;
            switch (root.tag) {
                case 'jv-object':
                    const prop = root.properties.find((p) => p.name === pathHead);
                    if (prop === undefined) {
                        return tea_cup_core_1.nothing;
                    }
                    return getValueAt(prop.value, path.tail());
                case 'jv-array':
                    const index = parseInt(pathHead);
                    if (isNaN(index)) {
                        return tea_cup_core_1.nothing;
                    }
                    const elem = root.elems[index];
                    if (elem === undefined) {
                        return tea_cup_core_1.nothing;
                    }
                    return getValueAt(elem, path.tail());
                default:
                    return (0, tea_cup_core_1.just)(root);
            }
        }
        case 'Nothing': {
            // empty path
            return (0, tea_cup_core_1.just)(root);
        }
    }
}
exports.getValueAt = getValueAt;
function mapValueAt(root, path, f) {
    const ph = path.head();
    switch (ph.type) {
        case 'Nothing': {
            return f(root);
        }
        case 'Just': {
            const pathHead = ph.value;
            switch (root.tag) {
                case 'jv-object': {
                    return (0, tea_cup_core_1.just)(jvObject(root.properties.flatMap((prop) => {
                        if (prop.name === pathHead) {
                            return mapValueAt(prop.value, path.tail(), f)
                                .map((value) => [
                                Object.assign(Object.assign({}, prop), { value }),
                            ])
                                .withDefault([]);
                        }
                        else {
                            return [prop];
                        }
                    })));
                }
                case 'jv-array': {
                    const pathIndex = parseInt(pathHead);
                    if (isNaN(pathIndex)) {
                        return (0, tea_cup_core_1.just)(root);
                    }
                    return (0, tea_cup_core_1.just)(jvArray(root.elems.flatMap((elem, elemIndex) => {
                        if (elemIndex === pathIndex) {
                            return mapValueAt(elem, path.tail(), f)
                                .map((value) => [value])
                                .withDefault([]);
                        }
                        else {
                            return [elem];
                        }
                    })));
                }
                default: {
                    return (0, tea_cup_core_1.just)(root);
                }
                // }
            }
        }
    }
}
exports.mapValueAt = mapValueAt;
function moveElems(array, index, direction) {
    const newIndex = index + (direction === 'up' ? -1 : 1);
    if (newIndex < 0 || newIndex > array.length - 1) {
        return array;
    }
    const newArray = new Array(...array);
    newArray[index] = array[newIndex];
    newArray[newIndex] = array[index];
    return newArray;
}
function moveProperty(root, objectPath, propertyName, direction) {
    return mapValueAt(root, objectPath, (value) => {
        if (value.tag === 'jv-object') {
            const propIndex = value.properties.findIndex((p) => p.name === propertyName);
            const newProps = moveElems(value.properties, propIndex, direction);
            const newObject = Object.assign(Object.assign({}, value), { properties: newProps });
            return (0, tea_cup_core_1.just)(newObject);
        }
        return (0, tea_cup_core_1.just)(value);
    }).withDefault(root);
}
exports.moveProperty = moveProperty;
function moveElement(root, arrayPath, elemIndex, direction) {
    return mapValueAt(root, arrayPath, (value) => {
        if (value.tag === 'jv-array') {
            const newElems = moveElems(value.elems, elemIndex, direction);
            const newArray = Object.assign(Object.assign({}, value), { elems: newElems });
            return (0, tea_cup_core_1.just)(newArray);
        }
        return (0, tea_cup_core_1.just)(value);
    }).withDefault(root);
}
exports.moveElement = moveElement;
function mergeProperties(from, into) {
    // keep set of prop names to avoid overwriting existing stuff in dst
    const dstPropNames = new Set(into.properties.map((p) => p.name));
    const newProps = new Array(...into.properties);
    from.properties.forEach((p) => {
        if (!dstPropNames.has(p.name)) {
            newProps.push(p);
        }
    });
    return jvObject(newProps);
}
exports.mergeProperties = mergeProperties;
function indexOfPathInParent(root, path) {
    return path
        .parent()
        .andThen((parentPath) => path.lastElem().andThen((lastPathElem) => getValueAt(root, parentPath).map((parentValue) => {
        switch (parentValue.tag) {
            case 'jv-object': {
                return parentValue.properties.findIndex((p) => p.name === lastPathElem);
            }
            case 'jv-array': {
                const i = parseInt(lastPathElem);
                if (isNaN(i)) {
                    return -1;
                }
                return i;
            }
            default:
                return -1;
        }
    })))
        .withDefault(-1);
}
exports.indexOfPathInParent = indexOfPathInParent;
function clearPropertiesIfObject(v) {
    if (v.tag === 'jv-object') {
        return jvObject();
    }
    return v;
}
exports.clearPropertiesIfObject = clearPropertiesIfObject;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSnNvblZhbHVlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL0pzb25WYWx1ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7O0dBY0c7OztBQUVILCtDQUFxRTtBQXdDeEQsUUFBQSxNQUFNLEdBQVcsRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLENBQUM7QUFFakQsU0FBZ0IsUUFBUSxDQUFDLEtBQWE7SUFDcEMsT0FBTztRQUNMLEdBQUcsRUFBRSxXQUFXO1FBQ2hCLEtBQUs7S0FDTixDQUFDO0FBQ0osQ0FBQztBQUxELDRCQUtDO0FBRUQsU0FBZ0IsUUFBUSxDQUFDLEtBQWE7SUFDcEMsT0FBTztRQUNMLEdBQUcsRUFBRSxXQUFXO1FBQ2hCLEtBQUs7S0FDTixDQUFDO0FBQ0osQ0FBQztBQUxELDRCQUtDO0FBRUQsU0FBZ0IsTUFBTSxDQUFDLEtBQWM7SUFDbkMsT0FBTztRQUNMLEdBQUcsRUFBRSxZQUFZO1FBQ2pCLEtBQUs7S0FDTixDQUFDO0FBQ0osQ0FBQztBQUxELHdCQUtDO0FBRUQsU0FBZ0IsUUFBUSxDQUN0QixhQUEwQyxFQUFFO0lBRTVDLE9BQU87UUFDTCxHQUFHLEVBQUUsV0FBVztRQUNoQixVQUFVO0tBQ1gsQ0FBQztBQUNKLENBQUM7QUFQRCw0QkFPQztBQUNELFNBQWdCLE9BQU8sQ0FBQyxRQUFrQyxFQUFFO0lBQzFELE9BQU87UUFDTCxHQUFHLEVBQUUsVUFBVTtRQUNmLEtBQUs7S0FDTixDQUFDO0FBQ0osQ0FBQztBQUxELDBCQUtDO0FBZUQsU0FBZ0IsU0FBUyxDQUFDLEtBQWdCO0lBQ3hDLFFBQVEsS0FBSyxDQUFDLEdBQUcsRUFBRTtRQUNqQixLQUFLLFdBQVc7WUFDZCxPQUFPLFFBQVEsQ0FBQztRQUNsQixLQUFLLFdBQVc7WUFDZCxPQUFPLFFBQVEsQ0FBQztRQUNsQixLQUFLLFdBQVc7WUFDZCxPQUFPLFFBQVEsQ0FBQztRQUNsQixLQUFLLFNBQVM7WUFDWixPQUFPLE1BQU0sQ0FBQztRQUNoQixLQUFLLFlBQVk7WUFDZixPQUFPLFNBQVMsQ0FBQztRQUNuQixLQUFLLFVBQVU7WUFDYixPQUFPLE9BQU8sQ0FBQztLQUNsQjtBQUNILENBQUM7QUFmRCw4QkFlQztBQUVELFNBQWdCLFlBQVksQ0FBQyxLQUFVO0lBQ3JDLElBQUksS0FBSyxLQUFLLFNBQVMsRUFBRTtRQUN2QixPQUFPLElBQUEsa0JBQUcsRUFBQyxXQUFXLENBQUMsQ0FBQztLQUN6QjtJQUNELElBQUksS0FBSyxLQUFLLElBQUksRUFBRTtRQUNsQixPQUFPLElBQUEsaUJBQUUsRUFBQyxjQUFNLENBQUMsQ0FBQztLQUNuQjtJQUNELElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUN4QixNQUFNLENBQUMsR0FBRyxLQUFjLENBQUM7UUFDekIsTUFBTSxLQUFLLEdBQUcsRUFBRSxDQUFDO1FBQ2pCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ2pDLE1BQU0sU0FBUyxHQUFHLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNyQyxRQUFRLFNBQVMsQ0FBQyxHQUFHLEVBQUU7Z0JBQ3JCLEtBQUssSUFBSSxDQUFDLENBQUM7b0JBQ1QsS0FBSyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7b0JBQzVCLE1BQU07aUJBQ1A7Z0JBQ0QsS0FBSyxLQUFLLENBQUMsQ0FBQztvQkFDVixPQUFPLFNBQVMsQ0FBQztpQkFDbEI7YUFDRjtTQUNGO1FBQ0QsT0FBTyxJQUFBLGlCQUFFLEVBQUM7WUFDUixHQUFHLEVBQUUsVUFBVTtZQUNmLEtBQUs7U0FDTixDQUFDLENBQUM7S0FDSjtJQUNELE1BQU0sU0FBUyxHQUFHLE9BQU8sS0FBSyxDQUFDO0lBQy9CLFFBQVEsU0FBUyxFQUFFO1FBQ2pCLEtBQUssUUFBUTtZQUNYLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQ3hCLE9BQU8sSUFBQSxrQkFBRyxFQUFDLHVCQUF1QixDQUFDLENBQUM7YUFDckM7WUFDRCxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2hDLE1BQU0sVUFBVSxHQUF3QixFQUFFLENBQUM7WUFDM0MsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ3BDLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDekIsTUFBTSxTQUFTLEdBQUcsWUFBWSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO2dCQUNoRCxRQUFRLFNBQVMsQ0FBQyxHQUFHLEVBQUU7b0JBQ3JCLEtBQUssSUFBSSxDQUFDLENBQUM7d0JBQ1QsVUFBVSxDQUFDLElBQUksQ0FBQzs0QkFDZCxJQUFJLEVBQUUsUUFBUTs0QkFDZCxLQUFLLEVBQUUsU0FBUyxDQUFDLEtBQUs7eUJBQ3ZCLENBQUMsQ0FBQzt3QkFDSCxNQUFNO3FCQUNQO29CQUNELEtBQUssS0FBSyxDQUFDLENBQUM7d0JBQ1YsT0FBTyxTQUFTLENBQUM7cUJBQ2xCO2lCQUNGO2FBQ0Y7WUFFRCxPQUFPLElBQUEsaUJBQUUsRUFBQyxFQUFFLEdBQUcsRUFBRSxXQUFXLEVBQUUsVUFBVSxFQUFFLENBQUMsQ0FBQztRQUM5QyxLQUFLLFFBQVE7WUFDWCxPQUFPLElBQUEsaUJBQUUsRUFBQyxFQUFFLEdBQUcsRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUN6QyxLQUFLLFNBQVM7WUFDWixPQUFPLElBQUEsaUJBQUUsRUFBQyxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUMxQyxLQUFLLFFBQVE7WUFDWCxPQUFPLElBQUEsaUJBQUUsRUFBQyxFQUFFLEdBQUcsRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDM0Q7WUFDRSxPQUFPLElBQUEsa0JBQUcsRUFBQyxTQUFTLENBQUMsQ0FBQztLQUN6QjtBQUNILENBQUM7QUE5REQsb0NBOERDO0FBRUQsU0FBZ0IsVUFBVSxDQUFDLEtBQWdCO0lBQ3pDLFFBQVEsS0FBSyxDQUFDLEdBQUcsRUFBRTtRQUNqQixLQUFLLFVBQVU7WUFDYixPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3JDLEtBQUssV0FBVyxDQUFDLENBQUM7WUFDaEIsTUFBTSxHQUFHLEdBQVEsRUFBRSxDQUFDO1lBQ3BCLEtBQUssQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7Z0JBQzdCLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsVUFBVSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxDQUFDLENBQUMsQ0FBQztZQUNILE9BQU8sR0FBRyxDQUFDO1NBQ1o7UUFDRCxLQUFLLFlBQVk7WUFDZixPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUM7UUFDckIsS0FBSyxTQUFTO1lBQ1osT0FBTyxJQUFJLENBQUM7UUFDZCxLQUFLLFdBQVc7WUFDZCxNQUFNLE1BQU0sR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3ZDLE9BQU8sS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7UUFDOUMsS0FBSyxXQUFXLENBQUMsQ0FBQztZQUNoQixPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUM7U0FDcEI7S0FDRjtBQUNILENBQUM7QUF0QkQsZ0NBc0JDO0FBRUQsU0FBUyxZQUFZLENBQUMsSUFBUztJQUM3QixJQUFJLEtBQUssR0FBRyxJQUFJLENBQUM7SUFDakIsT0FBTyxPQUFPLElBQUksS0FBSyxRQUFRLElBQUksSUFBSSxLQUFLLElBQUk7UUFDOUMsQ0FBQyxDQUFDLEtBQUs7UUFDUCxDQUFDLENBQUMsQ0FBQztZQUNDLE9BQU8sSUFBSSxFQUFFO2dCQUNYLElBQ0UsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7b0JBQzdELElBQUksRUFDSjtvQkFDQSxNQUFNO2lCQUNQO2FBQ0Y7WUFDRCxPQUFPLE1BQU0sQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEtBQUssS0FBSyxDQUFDO1FBQy9DLENBQUMsQ0FBQyxFQUFFLENBQUM7QUFDWCxDQUFDO0FBRUQsU0FBZ0IsY0FBYyxDQUFDLElBQVk7SUFDekMsSUFBSTtRQUNGLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDM0IsT0FBTyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDeEI7SUFBQyxPQUFPLENBQUMsRUFBRTtRQUNWLElBQUksQ0FBQyxZQUFZLEtBQUssRUFBRTtZQUN0QixPQUFPLElBQUEsa0JBQUcsRUFBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDdkI7UUFDRCxPQUFPLElBQUEsa0JBQUcsRUFBQyxrQkFBa0IsR0FBRyxDQUFDLENBQUMsQ0FBQztLQUNwQztBQUNILENBQUM7QUFWRCx3Q0FVQztBQUVELFNBQWdCLFVBQVUsQ0FDeEIsSUFBZSxFQUNmLElBQVksRUFDWixLQUFnQjtJQUVoQixPQUFPLFVBQVUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUEsbUJBQUksRUFBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNyRSxDQUFDO0FBTkQsZ0NBTUM7QUFFRCxTQUFnQixhQUFhLENBQUMsSUFBZSxFQUFFLElBQVk7SUFDekQsT0FBTyxVQUFVLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsQ0FBQyxzQkFBTyxDQUFDLENBQUM7QUFDL0MsQ0FBQztBQUZELHNDQUVDO0FBRUQsU0FBZ0IsVUFBVSxDQUFDLElBQWUsRUFBRSxJQUFZO0lBQ3RELE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUN2QixRQUFRLEVBQUUsQ0FBQyxJQUFJLEVBQUU7UUFDZixLQUFLLE1BQU0sQ0FBQyxDQUFDO1lBQ1gsTUFBTSxRQUFRLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQztZQUMxQixRQUFRLElBQUksQ0FBQyxHQUFHLEVBQUU7Z0JBQ2hCLEtBQUssV0FBVztvQkFDZCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxRQUFRLENBQUMsQ0FBQztvQkFDOUQsSUFBSSxJQUFJLEtBQUssU0FBUyxFQUFFO3dCQUN0QixPQUFPLHNCQUFPLENBQUM7cUJBQ2hCO29CQUNELE9BQU8sVUFBVSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7Z0JBQzdDLEtBQUssVUFBVTtvQkFDYixNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7b0JBQ2pDLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFO3dCQUNoQixPQUFPLHNCQUFPLENBQUM7cUJBQ2hCO29CQUNELE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7b0JBQy9CLElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRTt3QkFDdEIsT0FBTyxzQkFBTyxDQUFDO3FCQUNoQjtvQkFDRCxPQUFPLFVBQVUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7Z0JBQ3ZDO29CQUNFLE9BQU8sSUFBQSxtQkFBSSxFQUFDLElBQUksQ0FBQyxDQUFDO2FBQ3JCO1NBQ0Y7UUFDRCxLQUFLLFNBQVMsQ0FBQyxDQUFDO1lBQ2QsYUFBYTtZQUNiLE9BQU8sSUFBQSxtQkFBSSxFQUFDLElBQUksQ0FBQyxDQUFDO1NBQ25CO0tBQ0Y7QUFDSCxDQUFDO0FBL0JELGdDQStCQztBQUVELFNBQWdCLFVBQVUsQ0FDeEIsSUFBZSxFQUNmLElBQVksRUFDWixDQUF5QztJQUV6QyxNQUFNLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDdkIsUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFO1FBQ2YsS0FBSyxTQUFTLENBQUMsQ0FBQztZQUNkLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ2hCO1FBQ0QsS0FBSyxNQUFNLENBQUMsQ0FBQztZQUNYLE1BQU0sUUFBUSxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUM7WUFDMUIsUUFBUSxJQUFJLENBQUMsR0FBRyxFQUFFO2dCQUNoQixLQUFLLFdBQVcsQ0FBQyxDQUFDO29CQUNoQixPQUFPLElBQUEsbUJBQUksRUFDVCxRQUFRLENBQ04sSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTt3QkFDL0IsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsRUFBRTs0QkFDMUIsT0FBTyxVQUFVLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDO2lDQUMxQyxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDO2dFQUVULElBQUksS0FDUCxLQUFLOzZCQUVSLENBQUM7aUNBQ0QsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO3lCQUNwQjs2QkFBTTs0QkFDTCxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7eUJBQ2Y7b0JBQ0gsQ0FBQyxDQUFDLENBQ0gsQ0FDRixDQUFDO2lCQUNIO2dCQUNELEtBQUssVUFBVSxDQUFDLENBQUM7b0JBQ2YsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO29CQUNyQyxJQUFJLEtBQUssQ0FBQyxTQUFTLENBQUMsRUFBRTt3QkFDcEIsT0FBTyxJQUFBLG1CQUFJLEVBQUMsSUFBSSxDQUFDLENBQUM7cUJBQ25CO29CQUNELE9BQU8sSUFBQSxtQkFBSSxFQUNULE9BQU8sQ0FDTCxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksRUFBRSxTQUFTLEVBQUUsRUFBRTt3QkFDckMsSUFBSSxTQUFTLEtBQUssU0FBUyxFQUFFOzRCQUMzQixPQUFPLFVBQVUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQztpQ0FDcEMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO2lDQUN2QixXQUFXLENBQUMsRUFBRSxDQUFDLENBQUM7eUJBQ3BCOzZCQUFNOzRCQUNMLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQzt5QkFDZjtvQkFDSCxDQUFDLENBQUMsQ0FDSCxDQUNGLENBQUM7aUJBQ0g7Z0JBQ0QsT0FBTyxDQUFDLENBQUM7b0JBQ1AsT0FBTyxJQUFBLG1CQUFJLEVBQUMsSUFBSSxDQUFDLENBQUM7aUJBQ25CO2dCQUNELElBQUk7YUFDTDtTQUNGO0tBQ0Y7QUFDSCxDQUFDO0FBM0RELGdDQTJEQztBQUlELFNBQVMsU0FBUyxDQUNoQixLQUF1QixFQUN2QixLQUFhLEVBQ2IsU0FBd0I7SUFFeEIsTUFBTSxRQUFRLEdBQUcsS0FBSyxHQUFHLENBQUMsU0FBUyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3ZELElBQUksUUFBUSxHQUFHLENBQUMsSUFBSSxRQUFRLEdBQUcsS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7UUFDL0MsT0FBTyxLQUFLLENBQUM7S0FDZDtJQUNELE1BQU0sUUFBUSxHQUFHLElBQUksS0FBSyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUM7SUFDckMsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNsQyxRQUFRLENBQUMsUUFBUSxDQUFDLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLE9BQU8sUUFBUSxDQUFDO0FBQ2xCLENBQUM7QUFFRCxTQUFnQixZQUFZLENBQzFCLElBQWUsRUFDZixVQUFrQixFQUNsQixZQUFvQixFQUNwQixTQUF3QjtJQUV4QixPQUFPLFVBQVUsQ0FBQyxJQUFJLEVBQUUsVUFBVSxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUU7UUFDNUMsSUFBSSxLQUFLLENBQUMsR0FBRyxLQUFLLFdBQVcsRUFBRTtZQUM3QixNQUFNLFNBQVMsR0FBRyxLQUFLLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FDMUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssWUFBWSxDQUMvQixDQUFDO1lBQ0YsTUFBTSxRQUFRLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ25FLE1BQU0sU0FBUyxtQ0FDVixLQUFLLEtBQ1IsVUFBVSxFQUFFLFFBQVEsR0FDckIsQ0FBQztZQUNGLE9BQU8sSUFBQSxtQkFBSSxFQUFDLFNBQVMsQ0FBQyxDQUFDO1NBQ3hCO1FBQ0QsT0FBTyxJQUFBLG1CQUFJLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDckIsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3ZCLENBQUM7QUFwQkQsb0NBb0JDO0FBRUQsU0FBZ0IsV0FBVyxDQUN6QixJQUFlLEVBQ2YsU0FBaUIsRUFDakIsU0FBaUIsRUFDakIsU0FBd0I7SUFFeEIsT0FBTyxVQUFVLENBQUMsSUFBSSxFQUFFLFNBQVMsRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO1FBQzNDLElBQUksS0FBSyxDQUFDLEdBQUcsS0FBSyxVQUFVLEVBQUU7WUFDNUIsTUFBTSxRQUFRLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQzlELE1BQU0sUUFBUSxtQ0FDVCxLQUFLLEtBQ1IsS0FBSyxFQUFFLFFBQVEsR0FDaEIsQ0FBQztZQUNGLE9BQU8sSUFBQSxtQkFBSSxFQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQ3ZCO1FBQ0QsT0FBTyxJQUFBLG1CQUFJLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDckIsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3ZCLENBQUM7QUFqQkQsa0NBaUJDO0FBRUQsU0FBZ0IsZUFBZSxDQUFDLElBQWMsRUFBRSxJQUFjO0lBQzVELG9FQUFvRTtJQUNwRSxNQUFNLFlBQVksR0FBRyxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDakUsTUFBTSxRQUFRLEdBQUcsSUFBSSxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDL0MsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtRQUM1QixJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDN0IsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNsQjtJQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0gsT0FBTyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDNUIsQ0FBQztBQVZELDBDQVVDO0FBRUQsU0FBZ0IsbUJBQW1CLENBQUMsSUFBZSxFQUFFLElBQVk7SUFDL0QsT0FBTyxJQUFJO1NBQ1IsTUFBTSxFQUFFO1NBQ1IsT0FBTyxDQUFDLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FDdEIsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksRUFBRSxFQUFFLENBQ3ZDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLEVBQUU7UUFDL0MsUUFBUSxXQUFXLENBQUMsR0FBRyxFQUFFO1lBQ3ZCLEtBQUssV0FBVyxDQUFDLENBQUM7Z0JBQ2hCLE9BQU8sV0FBVyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQ3JDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLFlBQVksQ0FDL0IsQ0FBQzthQUNIO1lBQ0QsS0FBSyxVQUFVLENBQUMsQ0FBQztnQkFDZixNQUFNLENBQUMsR0FBRyxRQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7Z0JBQ2pDLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFO29CQUNaLE9BQU8sQ0FBQyxDQUFDLENBQUM7aUJBQ1g7Z0JBQ0QsT0FBTyxDQUFDLENBQUM7YUFDVjtZQUNEO2dCQUNFLE9BQU8sQ0FBQyxDQUFDLENBQUM7U0FDYjtJQUNILENBQUMsQ0FBQyxDQUNILENBQ0Y7U0FDQSxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNyQixDQUFDO0FBMUJELGtEQTBCQztBQUVELFNBQWdCLHVCQUF1QixDQUFDLENBQVk7SUFDbEQsSUFBSSxDQUFDLENBQUMsR0FBRyxLQUFLLFdBQVcsRUFBRTtRQUN6QixPQUFPLFFBQVEsRUFBRSxDQUFDO0tBQ25CO0lBQ0QsT0FBTyxDQUFDLENBQUM7QUFDWCxDQUFDO0FBTEQsMERBS0MiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIERpZXNlbCBBdXRob3JzXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IGVyciwganVzdCwgTWF5YmUsIG5vdGhpbmcsIG9rLCBSZXN1bHQgfSBmcm9tICd0ZWEtY3VwLWNvcmUnO1xuaW1wb3J0IHsgSnNQYXRoIH0gZnJvbSAnLi9Kc1BhdGgnO1xuXG5leHBvcnQgdHlwZSBKc29uVmFsdWUgPVxuICB8IEp2TnVsbFxuICB8IEp2U3RyaW5nXG4gIHwgSnZCb29sZWFuXG4gIHwgSnZOdW1iZXJcbiAgfCBKdkFycmF5XG4gIHwgSnZPYmplY3Q7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSnZOdWxsIHtcbiAgcmVhZG9ubHkgdGFnOiAnanYtbnVsbCc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSnZTdHJpbmcge1xuICByZWFkb25seSB0YWc6ICdqdi1zdHJpbmcnO1xuICByZWFkb25seSB2YWx1ZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEp2Qm9vbGVhbiB7XG4gIHJlYWRvbmx5IHRhZzogJ2p2LWJvb2xlYW4nO1xuICByZWFkb25seSB2YWx1ZTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBKdk51bWJlciB7XG4gIHJlYWRvbmx5IHRhZzogJ2p2LW51bWJlcic7XG4gIHJlYWRvbmx5IHZhbHVlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSnZBcnJheSB7XG4gIHJlYWRvbmx5IHRhZzogJ2p2LWFycmF5JztcbiAgcmVhZG9ubHkgZWxlbXM6IFJlYWRvbmx5QXJyYXk8SnNvblZhbHVlPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBKdk9iamVjdCB7XG4gIHJlYWRvbmx5IHRhZzogJ2p2LW9iamVjdCc7XG4gIHJlYWRvbmx5IHByb3BlcnRpZXM6IFJlYWRvbmx5QXJyYXk8SnNvblByb3BlcnR5Pjtcbn1cblxuZXhwb3J0IGNvbnN0IGp2TnVsbDogSnZOdWxsID0geyB0YWc6ICdqdi1udWxsJyB9O1xuXG5leHBvcnQgZnVuY3Rpb24ganZTdHJpbmcodmFsdWU6IHN0cmluZyk6IEp2U3RyaW5nIHtcbiAgcmV0dXJuIHtcbiAgICB0YWc6ICdqdi1zdHJpbmcnLFxuICAgIHZhbHVlLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24ganZOdW1iZXIodmFsdWU6IHN0cmluZyk6IEp2TnVtYmVyIHtcbiAgcmV0dXJuIHtcbiAgICB0YWc6ICdqdi1udW1iZXInLFxuICAgIHZhbHVlLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24ganZCb29sKHZhbHVlOiBib29sZWFuKTogSnZCb29sZWFuIHtcbiAgcmV0dXJuIHtcbiAgICB0YWc6ICdqdi1ib29sZWFuJyxcbiAgICB2YWx1ZSxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGp2T2JqZWN0KFxuICBwcm9wZXJ0aWVzOiBSZWFkb25seUFycmF5PEpzb25Qcm9wZXJ0eT4gPSBbXSxcbik6IEp2T2JqZWN0IHtcbiAgcmV0dXJuIHtcbiAgICB0YWc6ICdqdi1vYmplY3QnLFxuICAgIHByb3BlcnRpZXMsXG4gIH07XG59XG5leHBvcnQgZnVuY3Rpb24ganZBcnJheShlbGVtczogUmVhZG9ubHlBcnJheTxKc29uVmFsdWU+ID0gW10pOiBKdkFycmF5IHtcbiAgcmV0dXJuIHtcbiAgICB0YWc6ICdqdi1hcnJheScsXG4gICAgZWxlbXMsXG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSnNvblByb3BlcnR5IHtcbiAgcmVhZG9ubHkgbmFtZTogc3RyaW5nO1xuICByZWFkb25seSB2YWx1ZTogSnNvblZhbHVlO1xufVxuXG5leHBvcnQgdHlwZSBKc29uVmFsdWVUeXBlID1cbiAgfCAnc3RyaW5nJ1xuICB8ICdudW1iZXInXG4gIHwgJ2Jvb2xlYW4nXG4gIHwgJ251bGwnXG4gIHwgJ29iamVjdCdcbiAgfCAnYXJyYXknO1xuXG5leHBvcnQgZnVuY3Rpb24gdmFsdWVUeXBlKHZhbHVlOiBKc29uVmFsdWUpOiBKc29uVmFsdWVUeXBlIHtcbiAgc3dpdGNoICh2YWx1ZS50YWcpIHtcbiAgICBjYXNlICdqdi1zdHJpbmcnOlxuICAgICAgcmV0dXJuICdzdHJpbmcnO1xuICAgIGNhc2UgJ2p2LW9iamVjdCc6XG4gICAgICByZXR1cm4gJ29iamVjdCc7XG4gICAgY2FzZSAnanYtbnVtYmVyJzpcbiAgICAgIHJldHVybiAnbnVtYmVyJztcbiAgICBjYXNlICdqdi1udWxsJzpcbiAgICAgIHJldHVybiAnbnVsbCc7XG4gICAgY2FzZSAnanYtYm9vbGVhbic6XG4gICAgICByZXR1cm4gJ2Jvb2xlYW4nO1xuICAgIGNhc2UgJ2p2LWFycmF5JzpcbiAgICAgIHJldHVybiAnYXJyYXknO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWx1ZUZyb21BbnkodmFsdWU6IGFueSk6IFJlc3VsdDxzdHJpbmcsIEpzb25WYWx1ZT4ge1xuICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBlcnIoJ3VuZGVmaW5lZCcpO1xuICB9XG4gIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgIHJldHVybiBvayhqdk51bGwpO1xuICB9XG4gIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgIGNvbnN0IGEgPSB2YWx1ZSBhcyBhbnlbXTtcbiAgICBjb25zdCBlbGVtcyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgZWxlbVZhbHVlID0gdmFsdWVGcm9tQW55KGFbaV0pO1xuICAgICAgc3dpdGNoIChlbGVtVmFsdWUudGFnKSB7XG4gICAgICAgIGNhc2UgJ09rJzoge1xuICAgICAgICAgIGVsZW1zLnB1c2goZWxlbVZhbHVlLnZhbHVlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdFcnInOiB7XG4gICAgICAgICAgcmV0dXJuIGVsZW1WYWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2soe1xuICAgICAgdGFnOiAnanYtYXJyYXknLFxuICAgICAgZWxlbXMsXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgdmFsdWVUeXBlID0gdHlwZW9mIHZhbHVlO1xuICBzd2l0Y2ggKHZhbHVlVHlwZSkge1xuICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICBpZiAoIWlzT2JqTGl0ZXJhbCh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGVycignbm90IGFuIG9iamVjdCBsaXRlcmFsJyk7XG4gICAgICB9XG4gICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModmFsdWUpO1xuICAgICAgY29uc3QgcHJvcGVydGllczogQXJyYXk8SnNvblByb3BlcnR5PiA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHByb3BOYW1lID0ga2V5c1tpXTtcbiAgICAgICAgY29uc3QgcHJvcFZhbHVlID0gdmFsdWVGcm9tQW55KHZhbHVlW3Byb3BOYW1lXSk7XG4gICAgICAgIHN3aXRjaCAocHJvcFZhbHVlLnRhZykge1xuICAgICAgICAgIGNhc2UgJ09rJzoge1xuICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKHtcbiAgICAgICAgICAgICAgbmFtZTogcHJvcE5hbWUsXG4gICAgICAgICAgICAgIHZhbHVlOiBwcm9wVmFsdWUudmFsdWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlICdFcnInOiB7XG4gICAgICAgICAgICByZXR1cm4gcHJvcFZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gb2soeyB0YWc6ICdqdi1vYmplY3QnLCBwcm9wZXJ0aWVzIH0pO1xuICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICByZXR1cm4gb2soeyB0YWc6ICdqdi1zdHJpbmcnLCB2YWx1ZSB9KTtcbiAgICBjYXNlICdib29sZWFuJzpcbiAgICAgIHJldHVybiBvayh7IHRhZzogJ2p2LWJvb2xlYW4nLCB2YWx1ZSB9KTtcbiAgICBjYXNlICdudW1iZXInOlxuICAgICAgcmV0dXJuIG9rKHsgdGFnOiAnanYtbnVtYmVyJywgdmFsdWU6IHZhbHVlLnRvU3RyaW5nKCkgfSk7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBlcnIodmFsdWVUeXBlKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsdWVUb0FueSh2YWx1ZTogSnNvblZhbHVlKTogYW55IHtcbiAgc3dpdGNoICh2YWx1ZS50YWcpIHtcbiAgICBjYXNlICdqdi1hcnJheSc6XG4gICAgICByZXR1cm4gdmFsdWUuZWxlbXMubWFwKHZhbHVlVG9BbnkpO1xuICAgIGNhc2UgJ2p2LW9iamVjdCc6IHtcbiAgICAgIGNvbnN0IHJlczogYW55ID0ge307XG4gICAgICB2YWx1ZS5wcm9wZXJ0aWVzLmZvckVhY2goKHApID0+IHtcbiAgICAgICAgcmVzW3AubmFtZV0gPSB2YWx1ZVRvQW55KHAudmFsdWUpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBjYXNlICdqdi1ib29sZWFuJzpcbiAgICAgIHJldHVybiB2YWx1ZS52YWx1ZTtcbiAgICBjYXNlICdqdi1udWxsJzpcbiAgICAgIHJldHVybiBudWxsO1xuICAgIGNhc2UgJ2p2LW51bWJlcic6XG4gICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZUZsb2F0KHZhbHVlLnZhbHVlKTtcbiAgICAgIHJldHVybiBpc05hTihwYXJzZWQpID8gdmFsdWUudmFsdWUgOiBwYXJzZWQ7XG4gICAgY2FzZSAnanYtc3RyaW5nJzoge1xuICAgICAgcmV0dXJuIHZhbHVlLnZhbHVlO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBpc09iakxpdGVyYWwoX29iajogYW55KSB7XG4gIGxldCBfdGVzdCA9IF9vYmo7XG4gIHJldHVybiB0eXBlb2YgX29iaiAhPT0gJ29iamVjdCcgfHwgX29iaiA9PT0gbnVsbFxuICAgID8gZmFsc2VcbiAgICA6IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgT2JqZWN0LmdldFByb3RvdHlwZU9mKChfdGVzdCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihfdGVzdCkpKSA9PT1cbiAgICAgICAgICAgIG51bGxcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gT2JqZWN0LmdldFByb3RvdHlwZU9mKF9vYmopID09PSBfdGVzdDtcbiAgICAgIH0pKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUpzb25WYWx1ZShqc29uOiBzdHJpbmcpOiBSZXN1bHQ8c3RyaW5nLCBKc29uVmFsdWU+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB4ID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICByZXR1cm4gdmFsdWVGcm9tQW55KHgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKGUgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgcmV0dXJuIGVycihlLm1lc3NhZ2UpO1xuICAgIH1cbiAgICByZXR1cm4gZXJyKCd1bmhhbmRsZWQgZXJyb3IgJyArIGUpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRWYWx1ZUF0KFxuICByb290OiBKc29uVmFsdWUsXG4gIHBhdGg6IEpzUGF0aCxcbiAgdmFsdWU6IEpzb25WYWx1ZSxcbik6IEpzb25WYWx1ZSB7XG4gIHJldHVybiBtYXBWYWx1ZUF0KHJvb3QsIHBhdGgsICgpID0+IGp1c3QodmFsdWUpKS53aXRoRGVmYXVsdChyb290KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZVZhbHVlQXQocm9vdDogSnNvblZhbHVlLCBwYXRoOiBKc1BhdGgpOiBNYXliZTxKc29uVmFsdWU+IHtcbiAgcmV0dXJuIG1hcFZhbHVlQXQocm9vdCwgcGF0aCwgKCkgPT4gbm90aGluZyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRWYWx1ZUF0KHJvb3Q6IEpzb25WYWx1ZSwgcGF0aDogSnNQYXRoKTogTWF5YmU8SnNvblZhbHVlPiB7XG4gIGNvbnN0IHBoID0gcGF0aC5oZWFkKCk7XG4gIHN3aXRjaCAocGgudHlwZSkge1xuICAgIGNhc2UgJ0p1c3QnOiB7XG4gICAgICBjb25zdCBwYXRoSGVhZCA9IHBoLnZhbHVlO1xuICAgICAgc3dpdGNoIChyb290LnRhZykge1xuICAgICAgICBjYXNlICdqdi1vYmplY3QnOlxuICAgICAgICAgIGNvbnN0IHByb3AgPSByb290LnByb3BlcnRpZXMuZmluZCgocCkgPT4gcC5uYW1lID09PSBwYXRoSGVhZCk7XG4gICAgICAgICAgaWYgKHByb3AgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIG5vdGhpbmc7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBnZXRWYWx1ZUF0KHByb3AudmFsdWUsIHBhdGgudGFpbCgpKTtcbiAgICAgICAgY2FzZSAnanYtYXJyYXknOlxuICAgICAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQocGF0aEhlYWQpO1xuICAgICAgICAgIGlmIChpc05hTihpbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybiBub3RoaW5nO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBlbGVtID0gcm9vdC5lbGVtc1tpbmRleF07XG4gICAgICAgICAgaWYgKGVsZW0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIG5vdGhpbmc7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBnZXRWYWx1ZUF0KGVsZW0sIHBhdGgudGFpbCgpKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICByZXR1cm4ganVzdChyb290KTtcbiAgICAgIH1cbiAgICB9XG4gICAgY2FzZSAnTm90aGluZyc6IHtcbiAgICAgIC8vIGVtcHR5IHBhdGhcbiAgICAgIHJldHVybiBqdXN0KHJvb3QpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFwVmFsdWVBdChcbiAgcm9vdDogSnNvblZhbHVlLFxuICBwYXRoOiBKc1BhdGgsXG4gIGY6ICh2YWx1ZTogSnNvblZhbHVlKSA9PiBNYXliZTxKc29uVmFsdWU+LFxuKTogTWF5YmU8SnNvblZhbHVlPiB7XG4gIGNvbnN0IHBoID0gcGF0aC5oZWFkKCk7XG4gIHN3aXRjaCAocGgudHlwZSkge1xuICAgIGNhc2UgJ05vdGhpbmcnOiB7XG4gICAgICByZXR1cm4gZihyb290KTtcbiAgICB9XG4gICAgY2FzZSAnSnVzdCc6IHtcbiAgICAgIGNvbnN0IHBhdGhIZWFkID0gcGgudmFsdWU7XG4gICAgICBzd2l0Y2ggKHJvb3QudGFnKSB7XG4gICAgICAgIGNhc2UgJ2p2LW9iamVjdCc6IHtcbiAgICAgICAgICByZXR1cm4ganVzdChcbiAgICAgICAgICAgIGp2T2JqZWN0KFxuICAgICAgICAgICAgICByb290LnByb3BlcnRpZXMuZmxhdE1hcCgocHJvcCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwcm9wLm5hbWUgPT09IHBhdGhIZWFkKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbWFwVmFsdWVBdChwcm9wLnZhbHVlLCBwYXRoLnRhaWwoKSwgZilcbiAgICAgICAgICAgICAgICAgICAgLm1hcCgodmFsdWUpID0+IFtcbiAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5wcm9wLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICAgICAgLndpdGhEZWZhdWx0KFtdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFtwcm9wXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ2p2LWFycmF5Jzoge1xuICAgICAgICAgIGNvbnN0IHBhdGhJbmRleCA9IHBhcnNlSW50KHBhdGhIZWFkKTtcbiAgICAgICAgICBpZiAoaXNOYU4ocGF0aEluZGV4KSkge1xuICAgICAgICAgICAgcmV0dXJuIGp1c3Qocm9vdCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBqdXN0KFxuICAgICAgICAgICAganZBcnJheShcbiAgICAgICAgICAgICAgcm9vdC5lbGVtcy5mbGF0TWFwKChlbGVtLCBlbGVtSW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbUluZGV4ID09PSBwYXRoSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtYXBWYWx1ZUF0KGVsZW0sIHBhdGgudGFpbCgpLCBmKVxuICAgICAgICAgICAgICAgICAgICAubWFwKCh2YWx1ZSkgPT4gW3ZhbHVlXSlcbiAgICAgICAgICAgICAgICAgICAgLndpdGhEZWZhdWx0KFtdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFtlbGVtXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICByZXR1cm4ganVzdChyb290KTtcbiAgICAgICAgfVxuICAgICAgICAvLyB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCB0eXBlIE1vdmVEaXJlY3Rpb24gPSAndXAnIHwgJ2Rvd24nO1xuXG5mdW5jdGlvbiBtb3ZlRWxlbXM8VD4oXG4gIGFycmF5OiBSZWFkb25seUFycmF5PFQ+LFxuICBpbmRleDogbnVtYmVyLFxuICBkaXJlY3Rpb246IE1vdmVEaXJlY3Rpb24sXG4pOiBSZWFkb25seUFycmF5PFQ+IHtcbiAgY29uc3QgbmV3SW5kZXggPSBpbmRleCArIChkaXJlY3Rpb24gPT09ICd1cCcgPyAtMSA6IDEpO1xuICBpZiAobmV3SW5kZXggPCAwIHx8IG5ld0luZGV4ID4gYXJyYXkubGVuZ3RoIC0gMSkge1xuICAgIHJldHVybiBhcnJheTtcbiAgfVxuICBjb25zdCBuZXdBcnJheSA9IG5ldyBBcnJheSguLi5hcnJheSk7XG4gIG5ld0FycmF5W2luZGV4XSA9IGFycmF5W25ld0luZGV4XTtcbiAgbmV3QXJyYXlbbmV3SW5kZXhdID0gYXJyYXlbaW5kZXhdO1xuICByZXR1cm4gbmV3QXJyYXk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtb3ZlUHJvcGVydHkoXG4gIHJvb3Q6IEpzb25WYWx1ZSxcbiAgb2JqZWN0UGF0aDogSnNQYXRoLFxuICBwcm9wZXJ0eU5hbWU6IHN0cmluZyxcbiAgZGlyZWN0aW9uOiBNb3ZlRGlyZWN0aW9uLFxuKTogSnNvblZhbHVlIHtcbiAgcmV0dXJuIG1hcFZhbHVlQXQocm9vdCwgb2JqZWN0UGF0aCwgKHZhbHVlKSA9PiB7XG4gICAgaWYgKHZhbHVlLnRhZyA9PT0gJ2p2LW9iamVjdCcpIHtcbiAgICAgIGNvbnN0IHByb3BJbmRleCA9IHZhbHVlLnByb3BlcnRpZXMuZmluZEluZGV4KFxuICAgICAgICAocCkgPT4gcC5uYW1lID09PSBwcm9wZXJ0eU5hbWUsXG4gICAgICApO1xuICAgICAgY29uc3QgbmV3UHJvcHMgPSBtb3ZlRWxlbXModmFsdWUucHJvcGVydGllcywgcHJvcEluZGV4LCBkaXJlY3Rpb24pO1xuICAgICAgY29uc3QgbmV3T2JqZWN0OiBKdk9iamVjdCA9IHtcbiAgICAgICAgLi4udmFsdWUsXG4gICAgICAgIHByb3BlcnRpZXM6IG5ld1Byb3BzLFxuICAgICAgfTtcbiAgICAgIHJldHVybiBqdXN0KG5ld09iamVjdCk7XG4gICAgfVxuICAgIHJldHVybiBqdXN0KHZhbHVlKTtcbiAgfSkud2l0aERlZmF1bHQocm9vdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtb3ZlRWxlbWVudChcbiAgcm9vdDogSnNvblZhbHVlLFxuICBhcnJheVBhdGg6IEpzUGF0aCxcbiAgZWxlbUluZGV4OiBudW1iZXIsXG4gIGRpcmVjdGlvbjogTW92ZURpcmVjdGlvbixcbik6IEpzb25WYWx1ZSB7XG4gIHJldHVybiBtYXBWYWx1ZUF0KHJvb3QsIGFycmF5UGF0aCwgKHZhbHVlKSA9PiB7XG4gICAgaWYgKHZhbHVlLnRhZyA9PT0gJ2p2LWFycmF5Jykge1xuICAgICAgY29uc3QgbmV3RWxlbXMgPSBtb3ZlRWxlbXModmFsdWUuZWxlbXMsIGVsZW1JbmRleCwgZGlyZWN0aW9uKTtcbiAgICAgIGNvbnN0IG5ld0FycmF5OiBKdkFycmF5ID0ge1xuICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgZWxlbXM6IG5ld0VsZW1zLFxuICAgICAgfTtcbiAgICAgIHJldHVybiBqdXN0KG5ld0FycmF5KTtcbiAgICB9XG4gICAgcmV0dXJuIGp1c3QodmFsdWUpO1xuICB9KS53aXRoRGVmYXVsdChyb290KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlUHJvcGVydGllcyhmcm9tOiBKdk9iamVjdCwgaW50bzogSnZPYmplY3QpOiBKdk9iamVjdCB7XG4gIC8vIGtlZXAgc2V0IG9mIHByb3AgbmFtZXMgdG8gYXZvaWQgb3ZlcndyaXRpbmcgZXhpc3Rpbmcgc3R1ZmYgaW4gZHN0XG4gIGNvbnN0IGRzdFByb3BOYW1lcyA9IG5ldyBTZXQoaW50by5wcm9wZXJ0aWVzLm1hcCgocCkgPT4gcC5uYW1lKSk7XG4gIGNvbnN0IG5ld1Byb3BzID0gbmV3IEFycmF5KC4uLmludG8ucHJvcGVydGllcyk7XG4gIGZyb20ucHJvcGVydGllcy5mb3JFYWNoKChwKSA9PiB7XG4gICAgaWYgKCFkc3RQcm9wTmFtZXMuaGFzKHAubmFtZSkpIHtcbiAgICAgIG5ld1Byb3BzLnB1c2gocCk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIGp2T2JqZWN0KG5ld1Byb3BzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluZGV4T2ZQYXRoSW5QYXJlbnQocm9vdDogSnNvblZhbHVlLCBwYXRoOiBKc1BhdGgpOiBudW1iZXIge1xuICByZXR1cm4gcGF0aFxuICAgIC5wYXJlbnQoKVxuICAgIC5hbmRUaGVuKChwYXJlbnRQYXRoKSA9PlxuICAgICAgcGF0aC5sYXN0RWxlbSgpLmFuZFRoZW4oKGxhc3RQYXRoRWxlbSkgPT5cbiAgICAgICAgZ2V0VmFsdWVBdChyb290LCBwYXJlbnRQYXRoKS5tYXAoKHBhcmVudFZhbHVlKSA9PiB7XG4gICAgICAgICAgc3dpdGNoIChwYXJlbnRWYWx1ZS50YWcpIHtcbiAgICAgICAgICAgIGNhc2UgJ2p2LW9iamVjdCc6IHtcbiAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudFZhbHVlLnByb3BlcnRpZXMuZmluZEluZGV4KFxuICAgICAgICAgICAgICAgIChwKSA9PiBwLm5hbWUgPT09IGxhc3RQYXRoRWxlbSxcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ2p2LWFycmF5Jzoge1xuICAgICAgICAgICAgICBjb25zdCBpID0gcGFyc2VJbnQobGFzdFBhdGhFbGVtKTtcbiAgICAgICAgICAgICAgaWYgKGlzTmFOKGkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgIH1cbiAgICAgICAgfSksXG4gICAgICApLFxuICAgIClcbiAgICAud2l0aERlZmF1bHQoLTEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJQcm9wZXJ0aWVzSWZPYmplY3QodjogSnNvblZhbHVlKTogSnNvblZhbHVlIHtcbiAgaWYgKHYudGFnID09PSAnanYtb2JqZWN0Jykge1xuICAgIHJldHVybiBqdk9iamVjdCgpO1xuICB9XG4gIHJldHVybiB2O1xufVxuIl19