"use strict";
/*
 * Copyright 2018 The Diesel Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const ContextMenuActions_1 = require("./ContextMenuActions");
const JsonValue_1 = require("./JsonValue");
const JsPath_1 = require("./JsPath");
const tea_pop_menu_1 = require("tea-pop-menu");
const RenderOptions_1 = require("./RenderOptions");
describe('Change type menu', () => {
    test('[SM: ON, P: 1, V: valid] ' + 'no types menu', () => {
        const typesMenu = buildTypesMenuStrictMode([(0, JsonValue_1.jvNumber)('123'), (0, JsonValue_1.jvNumber)('456')], (0, JsonValue_1.jvNumber)('456'));
        expect(typesMenu).toStrictEqual([]);
    });
    test('[SM: ON, P: 2 same type, V: valid] ' + 'no types menu', () => {
        const typesMenu = buildTypesMenuStrictMode([(0, JsonValue_1.jvNumber)('123'), (0, JsonValue_1.jvNumber)('456')], (0, JsonValue_1.jvNumber)('456'));
        expect(typesMenu).toStrictEqual([]);
    });
    test('[SM: ON, P: 2 different type, V: something different than proposal] ' +
        'menu type exists and subMenu should contains 2 entries corresponding to the 2 proposals', () => {
        const typesMenu = buildTypesMenuStrictMode([(0, JsonValue_1.jvNumber)('123'), JsonValue_1.jvNull], (0, JsonValue_1.jvString)('Foo'));
        const expectedTypesMenu = buildExpectedTypesMenu([(0, JsonValue_1.jvNumber)('0'), JsonValue_1.jvNull]);
        expect(typesMenu).toStrictEqual(expectedTypesMenu);
    });
    test('[SM: ON, P: 2 different type, V: something equals than proposal] ' +
        'menu type exists and subMenu should contains 1 entry corresponding to the proposal that does not match the value', () => {
        const typesMenu = buildTypesMenuStrictMode([(0, JsonValue_1.jvNumber)('123'), JsonValue_1.jvNull], (0, JsonValue_1.jvNumber)('456'));
        const expectedTypesMenu = buildExpectedTypesMenu([JsonValue_1.jvNull]);
        expect(typesMenu).toStrictEqual(expectedTypesMenu);
    });
    test('[SM: ON, P: 1, V: wrong type]' +
        'menu type exists and subMenu should contains 1 entry corresponding to the proposal', () => {
        const typesMenu = buildTypesMenuStrictMode([(0, JsonValue_1.jvNumber)('123')], JsonValue_1.jvNull);
        const expectedTypesMenu = buildExpectedTypesMenu([(0, JsonValue_1.jvNumber)('0')]);
        expect(typesMenu).toStrictEqual(expectedTypesMenu);
    });
    test('[SM: OFF, whatever] ' +
        'menu type exists and subMenu should contains all available types', () => {
        const typesMenu = buildTypesMenu(JsonValue_1.jvNull);
        const expectedTypesMenu = buildExpectedTypesMenu([
            (0, JsonValue_1.jvString)(''),
            (0, JsonValue_1.jvNumber)('0'),
            (0, JsonValue_1.jvBool)(true),
            (0, JsonValue_1.jvObject)(),
            (0, JsonValue_1.jvArray)(),
        ]);
        expect(typesMenu).toStrictEqual(expectedTypesMenu);
    });
});
describe('menu render options', () => {
    describe('default options', () => {
        test('null value', () => {
            const props = {
                root: JsonValue_1.jvNull,
                path: JsPath_1.JsPath.empty,
                valueAtPath: JsonValue_1.jvNull,
                proposals: [],
                strictMode: false,
                menuFilter: {},
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(menuActionTags(actual)).toEqual(['types', 'delete']);
        });
        test('empty object value', () => {
            const props = {
                root: (0, JsonValue_1.jvObject)(),
                path: JsPath_1.JsPath.empty,
                valueAtPath: (0, JsonValue_1.jvObject)(),
                proposals: [],
                strictMode: false,
                menuFilter: {},
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(menuActionTags(actual)).toEqual(['add', 'types', 'delete']);
        });
        test('empty array value', () => {
            const props = {
                root: (0, JsonValue_1.jvArray)(),
                path: JsPath_1.JsPath.empty,
                valueAtPath: (0, JsonValue_1.jvArray)(),
                proposals: [],
                strictMode: false,
                menuFilter: {},
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(menuActionTags(actual)).toEqual(['add', 'types', 'delete']);
        });
        test('value with proposals', () => {
            const props = {
                root: (0, JsonValue_1.jvArray)(),
                path: JsPath_1.JsPath.empty,
                valueAtPath: JsonValue_1.jvNull,
                proposals: [JsonValue_1.jvNull],
                strictMode: false,
                menuFilter: {},
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(menuActionTags(actual)).toEqual(['types', 'propose', 'delete']);
        });
        test('non empty object value with move', () => {
            const props = {
                root: (0, JsonValue_1.jvObject)([
                    { name: 'foo', value: JsonValue_1.jvNull },
                    { name: 'bar', value: JsonValue_1.jvNull },
                ]),
                path: JsPath_1.JsPath.empty.append('bar'),
                valueAtPath: JsonValue_1.jvNull,
                proposals: [],
                strictMode: false,
                menuFilter: {},
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(menuActionTags(actual)).toEqual(['move', 'types', 'delete']);
        });
        test('non empty array value with move', () => {
            const props = {
                root: (0, JsonValue_1.jvArray)([JsonValue_1.jvNull, JsonValue_1.jvNull]),
                path: JsPath_1.JsPath.empty.append(1),
                valueAtPath: JsonValue_1.jvNull,
                proposals: [],
                strictMode: false,
                menuFilter: {},
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(menuActionTags(actual)).toEqual(['move', 'types', 'delete']);
        });
    });
    describe('menu filtering options', () => {
        test('null value no delete', () => {
            const props = {
                root: JsonValue_1.jvNull,
                path: JsPath_1.JsPath.empty,
                valueAtPath: JsonValue_1.jvNull,
                proposals: [],
                strictMode: false,
                menuFilter: {
                    menuFilters: RenderOptions_1.MenuOptions.DELETE,
                },
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.ADD)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.CHANGE_TYPE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.DELETE)).toEqual(true);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.MOVE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.PROPOSE)).toEqual(false);
            expect(menuActionTags(actual)).toEqual(['types']);
        });
        test('empty object value no add or change type', () => {
            const props = {
                root: (0, JsonValue_1.jvObject)(),
                path: JsPath_1.JsPath.empty,
                valueAtPath: (0, JsonValue_1.jvObject)(),
                proposals: [],
                strictMode: false,
                menuFilter: {
                    menuFilters: RenderOptions_1.MenuOptions.ADD,
                },
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.ADD)).toEqual(true);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.CHANGE_TYPE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.DELETE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.MOVE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.PROPOSE)).toEqual(false);
            expect(menuActionTags(actual)).toEqual(['types', 'delete']);
        });
        test('empty array value no delete or change type', () => {
            const props = {
                root: (0, JsonValue_1.jvArray)(),
                path: JsPath_1.JsPath.empty,
                valueAtPath: (0, JsonValue_1.jvArray)(),
                proposals: [],
                strictMode: false,
                menuFilter: {
                    menuFilters: RenderOptions_1.MenuOptions.DELETE | RenderOptions_1.MenuOptions.CHANGE_TYPE,
                },
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.ADD)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.CHANGE_TYPE)).toEqual(true);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.DELETE)).toEqual(true);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.MOVE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.PROPOSE)).toEqual(false);
            expect(menuActionTags(actual)).toEqual(['add']);
        });
        test('value with proposals no propose or change type or add', () => {
            const props = {
                root: (0, JsonValue_1.jvArray)(),
                path: JsPath_1.JsPath.empty,
                valueAtPath: JsonValue_1.jvNull,
                proposals: [JsonValue_1.jvNull],
                strictMode: false,
                menuFilter: {
                    menuFilters: RenderOptions_1.MenuOptions.CHANGE_TYPE | RenderOptions_1.MenuOptions.PROPOSE | RenderOptions_1.MenuOptions.ADD,
                },
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.ADD)).toEqual(true);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.CHANGE_TYPE)).toEqual(true);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.DELETE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.MOVE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.PROPOSE)).toEqual(true);
            expect(menuActionTags(actual)).toEqual(['delete']);
        });
        test('non empty object value with move no change type', () => {
            const props = {
                root: (0, JsonValue_1.jvObject)([
                    { name: 'foo', value: JsonValue_1.jvNull },
                    { name: 'bar', value: JsonValue_1.jvNull },
                ]),
                path: JsPath_1.JsPath.empty.append('bar'),
                valueAtPath: JsonValue_1.jvNull,
                proposals: [],
                strictMode: false,
                menuFilter: {
                    menuFilters: RenderOptions_1.MenuOptions.CHANGE_TYPE,
                },
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.ADD)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.CHANGE_TYPE)).toEqual(true);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.DELETE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.MOVE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.PROPOSE)).toEqual(false);
            expect(menuActionTags(actual)).toEqual(['move', 'delete']);
        });
        test('non empty array value with move no change type or move', () => {
            const props = {
                root: (0, JsonValue_1.jvArray)([JsonValue_1.jvNull, JsonValue_1.jvNull]),
                path: JsPath_1.JsPath.empty.append(1),
                valueAtPath: JsonValue_1.jvNull,
                proposals: [],
                strictMode: false,
                menuFilter: {
                    menuFilters: RenderOptions_1.MenuOptions.MOVE | RenderOptions_1.MenuOptions.CHANGE_TYPE,
                },
            };
            const actual = (0, ContextMenuActions_1.createMenu)(props);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.ADD)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.CHANGE_TYPE)).toEqual(true);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.DELETE)).toEqual(false);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.MOVE)).toEqual(true);
            expect(getSelectedFilter(props, RenderOptions_1.MenuOptions.PROPOSE)).toEqual(false);
            expect(menuActionTags(actual)).toEqual(['delete']);
        });
    });
});
/*-----------*/
/*  Helpers  */
/*-----------*/
function buildTypesMenu(valueAtPath) {
    return (0, ContextMenuActions_1.createTypesMenu)(JsPath_1.JsPath.empty, valueAtPath, [], false);
}
function buildTypesMenuStrictMode(proposals, valueAtPath) {
    return (0, ContextMenuActions_1.createTypesMenu)(JsPath_1.JsPath.empty, valueAtPath, proposals, true);
}
function buildExpectedTypesMenu(values) {
    return [
        (0, tea_pop_menu_1.item)({ tag: 'types' }, (0, tea_pop_menu_1.menu)(values.map((v) => {
            return (0, tea_pop_menu_1.item)({ tag: 'change-type', path: JsPath_1.JsPath.empty, value: v });
        }))),
    ];
}
function menuActionTags(menu) {
    return menu.elems.flatMap((e) => {
        switch (e.tag) {
            case 'item':
                return [e.userData.tag];
            default:
                return [];
        }
    });
}
function getSelectedFilter(menuPropertyProps, filter) {
    var _a, _b;
    return (((_a = menuPropertyProps === null || menuPropertyProps === void 0 ? void 0 : menuPropertyProps.menuFilter) === null || _a === void 0 ? void 0 : _a.menuFilters) &&
        (((_b = menuPropertyProps === null || menuPropertyProps === void 0 ? void 0 : menuPropertyProps.menuFilter) === null || _b === void 0 ? void 0 : _b.menuFilters) & filter) === filter);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29udGV4dE1lbnVSZW5kZXJlci50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL0NvbnRleHRNZW51UmVuZGVyZXIudGVzdC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7OztHQWNHOztBQUVILDZEQUs4QjtBQUM5QiwyQ0FRcUI7QUFDckIscUNBQWtDO0FBQ2xDLCtDQUEwRDtBQUMxRCxtREFBOEM7QUFFOUMsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUNoQyxJQUFJLENBQUMsMkJBQTJCLEdBQUcsZUFBZSxFQUFFLEdBQUcsRUFBRTtRQUN2RCxNQUFNLFNBQVMsR0FBRyx3QkFBd0IsQ0FDeEMsQ0FBQyxJQUFBLG9CQUFRLEVBQUMsS0FBSyxDQUFDLEVBQUUsSUFBQSxvQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDLEVBQ2xDLElBQUEsb0JBQVEsRUFBQyxLQUFLLENBQUMsQ0FDaEIsQ0FBQztRQUNGLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDdEMsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMscUNBQXFDLEdBQUcsZUFBZSxFQUFFLEdBQUcsRUFBRTtRQUNqRSxNQUFNLFNBQVMsR0FBRyx3QkFBd0IsQ0FDeEMsQ0FBQyxJQUFBLG9CQUFRLEVBQUMsS0FBSyxDQUFDLEVBQUUsSUFBQSxvQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDLEVBQ2xDLElBQUEsb0JBQVEsRUFBQyxLQUFLLENBQUMsQ0FDaEIsQ0FBQztRQUNGLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDdEMsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQ0Ysc0VBQXNFO1FBQ3BFLHlGQUF5RixFQUMzRixHQUFHLEVBQUU7UUFDSCxNQUFNLFNBQVMsR0FBRyx3QkFBd0IsQ0FDeEMsQ0FBQyxJQUFBLG9CQUFR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QyxPQUFPO1FBQ0wsSUFBQSxtQkFBSSxFQUNGLEVBQUUsR0FBRyxFQUFFLE9BQU8sRUFBRSxFQUNoQixJQUFBLG1CQUFJLEVBQ0YsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO1lBQ2YsT0FBTyxJQUFBLG1CQUFJLEVBQUMsRUFBRSxHQUFHLEVBQUUsYUFBYSxFQUFFLElBQUksRUFBRSxlQUFNLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3BFLENBQUMsQ0FBQyxDQUNILENBQ0Y7S0FDRixDQUFDO0FBQ0osQ0FBQztBQUVELFNBQVMsY0FBYyxDQUFDLElBQXNCO0lBQzVDLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtRQUM5QixRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUU7WUFDYixLQUFLLE1BQU07Z0JBQ1QsT0FBTyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDMUI7Z0JBQ0UsT0FBTyxFQUFFLENBQUM7U0FDYjtJQUNILENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQUVELFNBQVMsaUJBQWlCLENBQ3hCLGlCQUFvQyxFQUNwQyxNQUFtQjs7SUFFbkIsT0FBTyxDQUNMLENBQUEsTUFBQSxpQkFBaUIsYUFBakIsaUJBQWlCLHVCQUFqQixpQkFBaUIsQ0FBRSxVQUFVLDBDQUFFLFdBQVc7UUFDMUMsQ0FBQyxDQUFBLE1BQUEsaUJBQWlCLGFBQWpCLGlCQUFpQix1QkFBakIsaUJBQWlCLENBQUUsVUFBVSwwQ0FBRSxXQUFXLElBQUcsTUFBTSxDQUFDLEtBQUssTUFBTSxDQUNqRSxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgRGllc2VsIEF1dGhvcnNcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgY3JlYXRlTWVudSxcbiAgY3JlYXRlVHlwZXNNZW51LFxuICBNZW51QWN0aW9uLFxuICBNZW51UHJvcGVydHlQcm9wcyxcbn0gZnJvbSAnLi9Db250ZXh0TWVudUFjdGlvbnMnO1xuaW1wb3J0IHtcbiAgSnNvblZhbHVlLFxuICBqdkFycmF5LFxuICBqdkJvb2wsXG4gIGp2TnVsbCxcbiAganZOdW1iZXIsXG4gIGp2T2JqZWN0LFxuICBqdlN0cmluZyxcbn0gZnJvbSAnLi9Kc29uVmFsdWUnO1xuaW1wb3J0IHsgSnNQYXRoIH0gZnJvbSAnLi9Kc1BhdGgnO1xuaW1wb3J0IHsgaXRlbSwgTWVudSwgbWVudSwgTWVudUl0ZW0gfSBmcm9tICd0ZWEtcG9wLW1lbnUnO1xuaW1wb3J0IHsgTWVudU9wdGlvbnMgfSBmcm9tICcuL1JlbmRlck9wdGlvbnMnO1xuXG5kZXNjcmliZSgnQ2hhbmdlIHR5cGUgbWVudScsICgpID0+IHtcbiAgdGVzdCgnW1NNOiBPTiwgUDogMSwgVjogdmFsaWRdICcgKyAnbm8gdHlwZXMgbWVudScsICgpID0+IHtcbiAgICBjb25zdCB0eXBlc01lbnUgPSBidWlsZFR5cGVzTWVudVN0cmljdE1vZGUoXG4gICAgICBbanZOdW1iZXIoJzEyMycpLCBqdk51bWJlcignNDU2JyldLFxuICAgICAganZOdW1iZXIoJzQ1NicpLFxuICAgICk7XG4gICAgZXhwZWN0KHR5cGVzTWVudSkudG9TdHJpY3RFcXVhbChbXSk7XG4gIH0pO1xuXG4gIHRlc3QoJ1tTTTogT04sIFA6IDIgc2FtZSB0eXBlLCBWOiB2YWxpZF0gJyArICdubyB0eXBlcyBtZW51JywgKCkgPT4ge1xuICAgIGNvbnN0IHR5cGVzTWVudSA9IGJ1aWxkVHlwZXNNZW51U3RyaWN0TW9kZShcbiAgICAgIFtqdk51bWJlcignMTIzJyksIGp2TnVtYmVyKCc0NTYnKV0sXG4gICAgICBqdk51bWJlcignNDU2JyksXG4gICAgKTtcbiAgICBleHBlY3QodHlwZXNNZW51KS50b1N0cmljdEVxdWFsKFtdKTtcbiAgfSk7XG5cbiAgdGVzdChcbiAgICAnW1NNOiBPTiwgUDogMiBkaWZmZXJlbnQgdHlwZSwgVjogc29tZXRoaW5nIGRpZmZlcmVudCB0aGFuIHByb3Bvc2FsXSAnICtcbiAgICAgICdtZW51IHR5cGUgZXhpc3RzIGFuZCBzdWJNZW51IHNob3VsZCBjb250YWlucyAyIGVudHJpZXMgY29ycmVzcG9uZGluZyB0byB0aGUgMiBwcm9wb3NhbHMnLFxuICAgICgpID0+IHtcbiAgICAgIGNvbnN0IHR5cGVzTWVudSA9IGJ1aWxkVHlwZXNNZW51U3RyaWN0TW9kZShcbiAgICAgICAgW2p2TnVtYmVyKCcxMjMnKSwganZOdWxsXSxcbiAgICAgICAganZTdHJpbmcoJ0ZvbycpLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGV4cGVjdGVkVHlwZXNNZW51ID0gYnVpbGRFeHBlY3RlZFR5cGVzTWVudShbanZOdW1iZXIoJzAnKSwganZOdWxsXSk7XG4gICAgICBleHBlY3QodHlwZXNNZW51KS50b1N0cmljdEVxdWFsKGV4cGVjdGVkVHlwZXNNZW51KTtcbiAgICB9LFxuICApO1xuXG4gIHRlc3QoXG4gICAgJ1tTTTogT04sIFA6IDIgZGlmZmVyZW50IHR5cGUsIFY6IHNvbWV0aGluZyBlcXVhbHMgdGhhbiBwcm9wb3NhbF0gJyArXG4gICAgICAnbWVudSB0eXBlIGV4aXN0cyBhbmQgc3ViTWVudSBzaG91bGQgY29udGFpbnMgMSBlbnRyeSBjb3JyZXNwb25kaW5nIHRvIHRoZSBwcm9wb3NhbCB0aGF0IGRvZXMgbm90IG1hdGNoIHRoZSB2YWx1ZScsXG4gICAgKCkgPT4ge1xuICAgICAgY29uc3QgdHlwZXNNZW51ID0gYnVpbGRUeXBlc01lbnVTdHJpY3RNb2RlKFxuICAgICAgICBbanZOdW1iZXIoJzEyMycpLCBqdk51bGxdLFxuICAgICAgICBqdk51bWJlcignNDU2JyksXG4gICAgICApO1xuICAgICAgY29uc3QgZXhwZWN0ZWRUeXBlc01lbnUgPSBidWlsZEV4cGVjdGVkVHlwZXNNZW51KFtqdk51bGxdKTtcbiAgICAgIGV4cGVjdCh0eXBlc01lbnUpLnRvU3RyaWN0RXF1YWwoZXhwZWN0ZWRUeXBlc01lbnUpO1xuICAgIH0sXG4gICk7XG5cbiAgdGVzdChcbiAgICAnW1NNOiBPTiwgUDogMSwgVjogd3JvbmcgdHlwZV0nICtcbiAgICAgICdtZW51IHR5cGUgZXhpc3RzIGFuZCBzdWJNZW51IHNob3VsZCBjb250YWlucyAxIGVudHJ5IGNvcnJlc3BvbmRpbmcgdG8gdGhlIHByb3Bvc2FsJyxcbiAgICAoKSA9PiB7XG4gICAgICBjb25zdCB0eXBlc01lbnUgPSBidWlsZFR5cGVzTWVudVN0cmljdE1vZGUoW2p2TnVtYmVyKCcxMjMnKV0sIGp2TnVsbCk7XG4gICAgICBjb25zdCBleHBlY3RlZFR5cGVzTWVudSA9IGJ1aWxkRXhwZWN0ZWRUeXBlc01lbnUoW2p2TnVtYmVyKCcwJyldKTtcbiAgICAgIGV4cGVjdCh0eXBlc01lbnUpLnRvU3RyaWN0RXF1YWwoZXhwZWN0ZWRUeXBlc01lbnUpO1xuICAgIH0sXG4gICk7XG5cbiAgdGVzdChcbiAgICAnW1NNOiBPRkYsIHdoYXRldmVyXSAnICtcbiAgICAgICdtZW51IHR5cGUgZXhpc3RzIGFuZCBzdWJNZW51IHNob3VsZCBjb250YWlucyBhbGwgYXZhaWxhYmxlIHR5cGVzJyxcbiAgICAoKSA9PiB7XG4gICAgICBjb25zdCB0eXBlc01lbnUgPSBidWlsZFR5cGVzTWVudShqdk51bGwpO1xuICAgICAgY29uc3QgZXhwZWN0ZWRUeXBlc01lbnUgPSBidWlsZEV4cGVjdGVkVHlwZXNNZW51KFtcbiAgICAgICAganZTdHJpbmcoJycpLFxuICAgICAgICBqdk51bWJlcignMCcpLFxuICAgICAgICBqdkJvb2wodHJ1ZSksXG4gICAgICAgIGp2T2JqZWN0KCksXG4gICAgICAgIGp2QXJyYXkoKSxcbiAgICAgIF0pO1xuICAgICAgZXhwZWN0KHR5cGVzTWVudSkudG9TdHJpY3RFcXVhbChleHBlY3RlZFR5cGVzTWVudSk7XG4gICAgfSxcbiAgKTtcbn0pO1xuXG5kZXNjcmliZSgnbWVudSByZW5kZXIgb3B0aW9ucycsICgpID0+IHtcbiAgZGVzY3JpYmUoJ2RlZmF1bHQgb3B0aW9ucycsICgpID0+IHtcbiAgICB0ZXN0KCdudWxsIHZhbHVlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvcHM6IE1lbnVQcm9wZXJ0eVByb3BzID0ge1xuICAgICAgICByb290OiBqdk51bGwsXG4gICAgICAgIHBhdGg6IEpzUGF0aC5lbXB0eSxcbiAgICAgICAgdmFsdWVBdFBhdGg6IGp2TnVsbCxcbiAgICAgICAgcHJvcG9zYWxzOiBbXSxcbiAgICAgICAgc3RyaWN0TW9kZTogZmFsc2UsXG4gICAgICAgIG1lbnVGaWx0ZXI6IHt9LFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGFjdHVhbCA9IGNyZWF0ZU1lbnUocHJvcHMpO1xuICAgICAgZXhwZWN0KG1lbnVBY3Rpb25UYWdzKGFjdHVhbCkpLnRvRXF1YWwoWyd0eXBlcycsICdkZWxldGUnXSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdlbXB0eSBvYmplY3QgdmFsdWUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9wczogTWVudVByb3BlcnR5UHJvcHMgPSB7XG4gICAgICAgIHJvb3Q6IGp2T2JqZWN0KCksXG4gICAgICAgIHBhdGg6IEpzUGF0aC5lbXB0eSxcbiAgICAgICAgdmFsdWVBdFBhdGg6IGp2T2JqZWN0KCksXG4gICAgICAgIHByb3Bvc2FsczogW10sXG4gICAgICAgIHN0cmljdE1vZGU6IGZhbHNlLFxuICAgICAgICBtZW51RmlsdGVyOiB7fSxcbiAgICAgIH07XG4gICAgICBjb25zdCBhY3R1YWwgPSBjcmVhdGVNZW51KHByb3BzKTtcbiAgICAgIGV4cGVjdChtZW51QWN0aW9uVGFncyhhY3R1YWwpKS50b0VxdWFsKFsnYWRkJywgJ3R5cGVzJywgJ2RlbGV0ZSddKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2VtcHR5IGFycmF5IHZhbHVlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvcHM6IE1lbnVQcm9wZXJ0eVByb3BzID0ge1xuICAgICAgICByb290OiBqdkFycmF5KCksXG4gICAgICAgIHBhdGg6IEpzUGF0aC5lbXB0eSxcbiAgICAgICAgdmFsdWVBdFBhdGg6IGp2QXJyYXkoKSxcbiAgICAgICAgcHJvcG9zYWxzOiBbXSxcbiAgICAgICAgc3RyaWN0TW9kZTogZmFsc2UsXG4gICAgICAgIG1lbnVGaWx0ZXI6IHt9LFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGFjdHVhbCA9IGNyZWF0ZU1lbnUocHJvcHMpO1xuICAgICAgZXhwZWN0KG1lbnVBY3Rpb25UYWdzKGFjdHVhbCkpLnRvRXF1YWwoWydhZGQnLCAndHlwZXMnLCAnZGVsZXRlJ10pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgndmFsdWUgd2l0aCBwcm9wb3NhbHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9wczogTWVudVByb3BlcnR5UHJvcHMgPSB7XG4gICAgICAgIHJvb3Q6IGp2QXJyYXkoKSxcbiAgICAgICAgcGF0aDogSnNQYXRoLmVtcHR5LFxuICAgICAgICB2YWx1ZUF0UGF0aDoganZOdWxsLFxuICAgICAgICBwcm9wb3NhbHM6IFtqdk51bGxdLFxuICAgICAgICBzdHJpY3RNb2RlOiBmYWxzZSxcbiAgICAgICAgbWVudUZpbHRlcjoge30sXG4gICAgICB9O1xuICAgICAgY29uc3QgYWN0dWFsID0gY3JlYXRlTWVudShwcm9wcyk7XG4gICAgICBleHBlY3QobWVudUFjdGlvblRhZ3MoYWN0dWFsKSkudG9FcXVhbChbJ3R5cGVzJywgJ3Byb3Bvc2UnLCAnZGVsZXRlJ10pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnbm9uIGVtcHR5IG9iamVjdCB2YWx1ZSB3aXRoIG1vdmUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9wczogTWVudVByb3BlcnR5UHJvcHMgPSB7XG4gICAgICAgIHJvb3Q6IGp2T2JqZWN0KFtcbiAgICAgICAgICB7IG5hbWU6ICdmb28nLCB2YWx1ZToganZOdWxsIH0sXG4gICAgICAgICAgeyBuYW1lOiAnYmFyJywgdmFsdWU6IGp2TnVsbCB9LFxuICAgICAgICBdKSxcbiAgICAgICAgcGF0aDogSnNQYXRoLmVtcHR5LmFwcGVuZCgnYmFyJyksXG4gICAgICAgIHZhbHVlQXRQYXRoOiBqdk51bGwsXG4gICAgICAgIHByb3Bvc2FsczogW10sXG4gICAgICAgIHN0cmljdE1vZGU6IGZhbHNlLFxuICAgICAgICBtZW51RmlsdGVyOiB7fSxcbiAgICAgIH07XG4gICAgICBjb25zdCBhY3R1YWwgPSBjcmVhdGVNZW51KHByb3BzKTtcbiAgICAgIGV4cGVjdChtZW51QWN0aW9uVGFncyhhY3R1YWwpKS50b0VxdWFsKFsnbW92ZScsICd0eXBlcycsICdkZWxldGUnXSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdub24gZW1wdHkgYXJyYXkgdmFsdWUgd2l0aCBtb3ZlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvcHM6IE1lbnVQcm9wZXJ0eVByb3BzID0ge1xuICAgICAgICByb290OiBqdkFycmF5KFtqdk51bGwsIGp2TnVsbF0pLFxuICAgICAgICBwYXRoOiBKc1BhdGguZW1wdHkuYXBwZW5kKDEpLFxuICAgICAgICB2YWx1ZUF0UGF0aDoganZOdWxsLFxuICAgICAgICBwcm9wb3NhbHM6IFtdLFxuICAgICAgICBzdHJpY3RNb2RlOiBmYWxzZSxcbiAgICAgICAgbWVudUZpbHRlcjoge30sXG4gICAgICB9O1xuICAgICAgY29uc3QgYWN0dWFsID0gY3JlYXRlTWVudShwcm9wcyk7XG4gICAgICBleHBlY3QobWVudUFjdGlvblRhZ3MoYWN0dWFsKSkudG9FcXVhbChbJ21vdmUnLCAndHlwZXMnLCAnZGVsZXRlJ10pO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ21lbnUgZmlsdGVyaW5nIG9wdGlvbnMnLCAoKSA9PiB7XG4gICAgdGVzdCgnbnVsbCB2YWx1ZSBubyBkZWxldGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9wczogTWVudVByb3BlcnR5UHJvcHMgPSB7XG4gICAgICAgIHJvb3Q6IGp2TnVsbCxcbiAgICAgICAgcGF0aDogSnNQYXRoLmVtcHR5LFxuICAgICAgICB2YWx1ZUF0UGF0aDoganZOdWxsLFxuICAgICAgICBwcm9wb3NhbHM6IFtdLFxuICAgICAgICBzdHJpY3RNb2RlOiBmYWxzZSxcbiAgICAgICAgbWVudUZpbHRlcjoge1xuICAgICAgICAgIG1lbnVGaWx0ZXJzOiBNZW51T3B0aW9ucy5ERUxFVEUsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgICAgY29uc3QgYWN0dWFsID0gY3JlYXRlTWVudShwcm9wcyk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLkFERCkpLnRvRXF1YWwoZmFsc2UpO1xuICAgICAgZXhwZWN0KGdldFNlbGVjdGVkRmlsdGVyKHByb3BzLCBNZW51T3B0aW9ucy5DSEFOR0VfVFlQRSkpLnRvRXF1YWwoZmFsc2UpO1xuICAgICAgZXhwZWN0KGdldFNlbGVjdGVkRmlsdGVyKHByb3BzLCBNZW51T3B0aW9ucy5ERUxFVEUpKS50b0VxdWFsKHRydWUpO1xuICAgICAgZXhwZWN0KGdldFNlbGVjdGVkRmlsdGVyKHByb3BzLCBNZW51T3B0aW9ucy5NT1ZFKSkudG9FcXVhbChmYWxzZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLlBST1BPU0UpKS50b0VxdWFsKGZhbHNlKTtcbiAgICAgIGV4cGVjdChtZW51QWN0aW9uVGFncyhhY3R1YWwpKS50b0VxdWFsKFsndHlwZXMnXSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdlbXB0eSBvYmplY3QgdmFsdWUgbm8gYWRkIG9yIGNoYW5nZSB0eXBlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvcHM6IE1lbnVQcm9wZXJ0eVByb3BzID0ge1xuICAgICAgICByb290OiBqdk9iamVjdCgpLFxuICAgICAgICBwYXRoOiBKc1BhdGguZW1wdHksXG4gICAgICAgIHZhbHVlQXRQYXRoOiBqdk9iamVjdCgpLFxuICAgICAgICBwcm9wb3NhbHM6IFtdLFxuICAgICAgICBzdHJpY3RNb2RlOiBmYWxzZSxcbiAgICAgICAgbWVudUZpbHRlcjoge1xuICAgICAgICAgIG1lbnVGaWx0ZXJzOiBNZW51T3B0aW9ucy5BREQsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgICAgY29uc3QgYWN0dWFsID0gY3JlYXRlTWVudShwcm9wcyk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLkFERCkpLnRvRXF1YWwodHJ1ZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLkNIQU5HRV9UWVBFKSkudG9FcXVhbChmYWxzZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLkRFTEVURSkpLnRvRXF1YWwoZmFsc2UpO1xuICAgICAgZXhwZWN0KGdldFNlbGVjdGVkRmlsdGVyKHByb3BzLCBNZW51T3B0aW9ucy5NT1ZFKSkudG9FcXVhbChmYWxzZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLlBST1BPU0UpKS50b0VxdWFsKGZhbHNlKTtcbiAgICAgIGV4cGVjdChtZW51QWN0aW9uVGFncyhhY3R1YWwpKS50b0VxdWFsKFsndHlwZXMnLCAnZGVsZXRlJ10pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnZW1wdHkgYXJyYXkgdmFsdWUgbm8gZGVsZXRlIG9yIGNoYW5nZSB0eXBlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvcHM6IE1lbnVQcm9wZXJ0eVByb3BzID0ge1xuICAgICAgICByb290OiBqdkFycmF5KCksXG4gICAgICAgIHBhdGg6IEpzUGF0aC5lbXB0eSxcbiAgICAgICAgdmFsdWVBdFBhdGg6IGp2QXJyYXkoKSxcbiAgICAgICAgcHJvcG9zYWxzOiBbXSxcbiAgICAgICAgc3RyaWN0TW9kZTogZmFsc2UsXG4gICAgICAgIG1lbnVGaWx0ZXI6IHtcbiAgICAgICAgICBtZW51RmlsdGVyczogTWVudU9wdGlvbnMuREVMRVRFIHwgTWVudU9wdGlvbnMuQ0hBTkdFX1RZUEUsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgICAgY29uc3QgYWN0dWFsID0gY3JlYXRlTWVudShwcm9wcyk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLkFERCkpLnRvRXF1YWwoZmFsc2UpO1xuICAgICAgZXhwZWN0KGdldFNlbGVjdGVkRmlsdGVyKHByb3BzLCBNZW51T3B0aW9ucy5DSEFOR0VfVFlQRSkpLnRvRXF1YWwodHJ1ZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLkRFTEVURSkpLnRvRXF1YWwodHJ1ZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLk1PVkUpKS50b0VxdWFsKGZhbHNlKTtcbiAgICAgIGV4cGVjdChnZXRTZWxlY3RlZEZpbHRlcihwcm9wcywgTWVudU9wdGlvbnMuUFJPUE9TRSkpLnRvRXF1YWwoZmFsc2UpO1xuICAgICAgZXhwZWN0KG1lbnVBY3Rpb25UYWdzKGFjdHVhbCkpLnRvRXF1YWwoWydhZGQnXSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCd2YWx1ZSB3aXRoIHByb3Bvc2FscyBubyBwcm9wb3NlIG9yIGNoYW5nZSB0eXBlIG9yIGFkZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHByb3BzOiBNZW51UHJvcGVydHlQcm9wcyA9IHtcbiAgICAgICAgcm9vdDoganZBcnJheSgpLFxuICAgICAgICBwYXRoOiBKc1BhdGguZW1wdHksXG4gICAgICAgIHZhbHVlQXRQYXRoOiBqdk51bGwsXG4gICAgICAgIHByb3Bvc2FsczogW2p2TnVsbF0sXG4gICAgICAgIHN0cmljdE1vZGU6IGZhbHNlLFxuICAgICAgICBtZW51RmlsdGVyOiB7XG4gICAgICAgICAgbWVudUZpbHRlcnM6XG4gICAgICAgICAgICBNZW51T3B0aW9ucy5DSEFOR0VfVFlQRSB8IE1lbnVPcHRpb25zLlBST1BPU0UgfCBNZW51T3B0aW9ucy5BREQsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgICAgY29uc3QgYWN0dWFsID0gY3JlYXRlTWVudShwcm9wcyk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLkFERCkpLnRvRXF1YWwodHJ1ZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLkNIQU5HRV9UWVBFKSkudG9FcXVhbCh0cnVlKTtcbiAgICAgIGV4cGVjdChnZXRTZWxlY3RlZEZpbHRlcihwcm9wcywgTWVudU9wdGlvbnMuREVMRVRFKSkudG9FcXVhbChmYWxzZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLk1PVkUpKS50b0VxdWFsKGZhbHNlKTtcbiAgICAgIGV4cGVjdChnZXRTZWxlY3RlZEZpbHRlcihwcm9wcywgTWVudU9wdGlvbnMuUFJPUE9TRSkpLnRvRXF1YWwodHJ1ZSk7XG4gICAgICBleHBlY3QobWVudUFjdGlvblRhZ3MoYWN0dWFsKSkudG9FcXVhbChbJ2RlbGV0ZSddKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ25vbiBlbXB0eSBvYmplY3QgdmFsdWUgd2l0aCBtb3ZlIG5vIGNoYW5nZSB0eXBlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvcHM6IE1lbnVQcm9wZXJ0eVByb3BzID0ge1xuICAgICAgICByb290OiBqdk9iamVjdChbXG4gICAgICAgICAgeyBuYW1lOiAnZm9vJywgdmFsdWU6IGp2TnVsbCB9LFxuICAgICAgICAgIHsgbmFtZTogJ2JhcicsIHZhbHVlOiBqdk51bGwgfSxcbiAgICAgICAgXSksXG4gICAgICAgIHBhdGg6IEpzUGF0aC5lbXB0eS5hcHBlbmQoJ2JhcicpLFxuICAgICAgICB2YWx1ZUF0UGF0aDoganZOdWxsLFxuICAgICAgICBwcm9wb3NhbHM6IFtdLFxuICAgICAgICBzdHJpY3RNb2RlOiBmYWxzZSxcbiAgICAgICAgbWVudUZpbHRlcjoge1xuICAgICAgICAgIG1lbnVGaWx0ZXJzOiBNZW51T3B0aW9ucy5DSEFOR0VfVFlQRSxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgICBjb25zdCBhY3R1YWwgPSBjcmVhdGVNZW51KHByb3BzKTtcbiAgICAgIGV4cGVjdChnZXRTZWxlY3RlZEZpbHRlcihwcm9wcywgTWVudU9wdGlvbnMuQUREKSkudG9FcXVhbChmYWxzZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLkNIQU5HRV9UWVBFKSkudG9FcXVhbCh0cnVlKTtcbiAgICAgIGV4cGVjdChnZXRTZWxlY3RlZEZpbHRlcihwcm9wcywgTWVudU9wdGlvbnMuREVMRVRFKSkudG9FcXVhbChmYWxzZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLk1PVkUpKS50b0VxdWFsKGZhbHNlKTtcbiAgICAgIGV4cGVjdChnZXRTZWxlY3RlZEZpbHRlcihwcm9wcywgTWVudU9wdGlvbnMuUFJPUE9TRSkpLnRvRXF1YWwoZmFsc2UpO1xuICAgICAgZXhwZWN0KG1lbnVBY3Rpb25UYWdzKGFjdHVhbCkpLnRvRXF1YWwoWydtb3ZlJywgJ2RlbGV0ZSddKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ25vbiBlbXB0eSBhcnJheSB2YWx1ZSB3aXRoIG1vdmUgbm8gY2hhbmdlIHR5cGUgb3IgbW92ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHByb3BzOiBNZW51UHJvcGVydHlQcm9wcyA9IHtcbiAgICAgICAgcm9vdDoganZBcnJheShbanZOdWxsLCBqdk51bGxdKSxcbiAgICAgICAgcGF0aDogSnNQYXRoLmVtcHR5LmFwcGVuZCgxKSxcbiAgICAgICAgdmFsdWVBdFBhdGg6IGp2TnVsbCxcbiAgICAgICAgcHJvcG9zYWxzOiBbXSxcbiAgICAgICAgc3RyaWN0TW9kZTogZmFsc2UsXG4gICAgICAgIG1lbnVGaWx0ZXI6IHtcbiAgICAgICAgICBtZW51RmlsdGVyczogTWVudU9wdGlvbnMuTU9WRSB8IE1lbnVPcHRpb25zLkNIQU5HRV9UWVBFLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGFjdHVhbCA9IGNyZWF0ZU1lbnUocHJvcHMpO1xuICAgICAgZXhwZWN0KGdldFNlbGVjdGVkRmlsdGVyKHByb3BzLCBNZW51T3B0aW9ucy5BREQpKS50b0VxdWFsKGZhbHNlKTtcbiAgICAgIGV4cGVjdChnZXRTZWxlY3RlZEZpbHRlcihwcm9wcywgTWVudU9wdGlvbnMuQ0hBTkdFX1RZUEUpKS50b0VxdWFsKHRydWUpO1xuICAgICAgZXhwZWN0KGdldFNlbGVjdGVkRmlsdGVyKHByb3BzLCBNZW51T3B0aW9ucy5ERUxFVEUpKS50b0VxdWFsKGZhbHNlKTtcbiAgICAgIGV4cGVjdChnZXRTZWxlY3RlZEZpbHRlcihwcm9wcywgTWVudU9wdGlvbnMuTU9WRSkpLnRvRXF1YWwodHJ1ZSk7XG4gICAgICBleHBlY3QoZ2V0U2VsZWN0ZWRGaWx0ZXIocHJvcHMsIE1lbnVPcHRpb25zLlBST1BPU0UpKS50b0VxdWFsKGZhbHNlKTtcbiAgICAgIGV4cGVjdChtZW51QWN0aW9uVGFncyhhY3R1YWwpKS50b0VxdWFsKFsnZGVsZXRlJ10pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG4vKi0tLS0tLS0tLS0tKi9cbi8qICBIZWxwZXJzICAqL1xuLyotLS0tLS0tLS0tLSovXG5cbmZ1bmN0aW9uIGJ1aWxkVHlwZXNNZW51KFxuICB2YWx1ZUF0UGF0aDogSnNvblZhbHVlLFxuKTogUmVhZG9ubHlBcnJheTxNZW51SXRlbTxNZW51QWN0aW9uPj4ge1xuICByZXR1cm4gY3JlYXRlVHlwZXNNZW51KEpzUGF0aC5lbXB0eSwgdmFsdWVBdFBhdGgsIFtdLCBmYWxzZSk7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkVHlwZXNNZW51U3RyaWN0TW9kZShcbiAgcHJvcG9zYWxzOiBSZWFkb25seUFycmF5PEpzb25WYWx1ZT4sXG4gIHZhbHVlQXRQYXRoOiBKc29uVmFsdWUsXG4pOiBSZWFkb25seUFycmF5PE1lbnVJdGVtPE1lbnVBY3Rpb24+PiB7XG4gIHJldHVybiBjcmVhdGVUeXBlc01lbnUoSnNQYXRoLmVtcHR5LCB2YWx1ZUF0UGF0aCwgcHJvcG9zYWxzLCB0cnVlKTtcbn1cblxuZnVuY3Rpb24gYnVpbGRFeHBlY3RlZFR5cGVzTWVudShcbiAgdmFsdWVzOiBSZWFkb25seUFycmF5PEpzb25WYWx1ZT4sXG4pOiBSZWFkb25seUFycmF5PE1lbnVJdGVtPE1lbnVBY3Rpb24+PiB7XG4gIHJldHVybiBbXG4gICAgaXRlbTxNZW51QWN0aW9uPihcbiAgICAgIHsgdGFnOiAndHlwZXMnIH0sXG4gICAgICBtZW51KFxuICAgICAgICB2YWx1ZXMubWFwKCh2KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW0oeyB0YWc6ICdjaGFuZ2UtdHlwZScsIHBhdGg6IEpzUGF0aC5lbXB0eSwgdmFsdWU6IHYgfSk7XG4gICAgICAgIH0pLFxuICAgICAgKSxcbiAgICApLFxuICBdO1xufVxuXG5mdW5jdGlvbiBtZW51QWN0aW9uVGFncyhtZW51OiBNZW51PE1lbnVBY3Rpb24+KTogUmVhZG9ubHlBcnJheTxzdHJpbmc+IHtcbiAgcmV0dXJuIG1lbnUuZWxlbXMuZmxhdE1hcCgoZSkgPT4ge1xuICAgIHN3aXRjaCAoZS50YWcpIHtcbiAgICAgIGNhc2UgJ2l0ZW0nOlxuICAgICAgICByZXR1cm4gW2UudXNlckRhdGEudGFnXTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRTZWxlY3RlZEZpbHRlcihcbiAgbWVudVByb3BlcnR5UHJvcHM6IE1lbnVQcm9wZXJ0eVByb3BzLFxuICBmaWx0ZXI6IE1lbnVPcHRpb25zLFxuKSB7XG4gIHJldHVybiAoXG4gICAgbWVudVByb3BlcnR5UHJvcHM/Lm1lbnVGaWx0ZXI/Lm1lbnVGaWx0ZXJzICYmXG4gICAgKG1lbnVQcm9wZXJ0eVByb3BzPy5tZW51RmlsdGVyPy5tZW51RmlsdGVycyAmIGZpbHRlcikgPT09IGZpbHRlclxuICApO1xufVxuIl19