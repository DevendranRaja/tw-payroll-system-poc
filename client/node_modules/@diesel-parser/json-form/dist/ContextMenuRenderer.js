"use strict";
/*
 * Copyright 2018 The Diesel Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.contextMenuRenderer = void 0;
const TPM = __importStar(require("tea-pop-menu"));
const react_1 = __importDefault(require("react"));
const JsonValue_1 = require("./JsonValue");
const tea_cup_core_1 = require("tea-cup-core");
const _16_1 = __importDefault(require("@carbon/icons-react/lib/add/16"));
const _16_2 = __importDefault(require("@carbon/icons-react/lib/arrow--down/16"));
const _16_3 = __importDefault(require("@carbon/icons-react/lib/arrows/16"));
const _16_4 = __importDefault(require("@carbon/icons-react/lib/arrow--up/16"));
const _16_5 = __importDefault(require("@carbon/icons-react/lib/checkbox--checked/16"));
const _16_6 = __importDefault(require("@carbon/icons-react/lib/close/16"));
const _16_7 = __importDefault(require("@carbon/icons-react/lib/decision-tree/16"));
const _16_8 = __importDefault(require("@carbon/icons-react/lib/magic-wand/16"));
const _16_9 = __importDefault(require("@carbon/icons-react/lib/not-available/16"));
const _16_10 = __importDefault(require("@carbon/icons-react/lib/string-integer/16"));
const _16_11 = __importDefault(require("@carbon/icons-react/lib/string-text/16"));
const _16_12 = __importDefault(require("@carbon/icons-react/lib/table/16"));
const _16_13 = __importDefault(require("@carbon/icons-react/lib/types/16"));
function contextMenuRenderer(t) {
    return TPM.defaultItemRenderer((a) => {
        const iconAndLabel = () => {
            switch (a.tag) {
                case 'move': {
                    return tea_cup_core_1.Tuple.t2((0, tea_cup_core_1.just)(react_1.default.createElement(_16_3.default, null)), t('contextMenu.move'));
                }
                case 'move-up': {
                    return tea_cup_core_1.Tuple.t2((0, tea_cup_core_1.just)(react_1.default.createElement(_16_4.default, null)), t('contextMenu.moveUp'));
                }
                case 'move-down': {
                    return tea_cup_core_1.Tuple.t2((0, tea_cup_core_1.just)(react_1.default.createElement(_16_2.default, null)), t('contextMenu.moveDown'));
                }
                case 'propose': {
                    return tea_cup_core_1.Tuple.t2((0, tea_cup_core_1.just)(react_1.default.createElement(_16_8.default, null)), t('contextMenu.propose'));
                }
                case 'delete': {
                    return tea_cup_core_1.Tuple.t2((0, tea_cup_core_1.just)(react_1.default.createElement(_16_6.default, null)), t('contextMenu.delete'));
                }
                case 'proposal': {
                    return tea_cup_core_1.Tuple.t2(typeIcon((0, JsonValue_1.valueType)(a.value)), getItemLabel(a.value));
                }
                case 'types': {
                    return tea_cup_core_1.Tuple.t2((0, tea_cup_core_1.just)(react_1.default.createElement(_16_13.default, null)), t('contextMenu.changeType'));
                }
                case 'change-type': {
                    const vt = (0, JsonValue_1.valueType)(a.value);
                    return tea_cup_core_1.Tuple.t2(typeIcon(vt), vt);
                }
                case 'add': {
                    const label = a.isArray
                        ? t('contextMenu.addElement')
                        : t('contextMenu.addProperty');
                    return tea_cup_core_1.Tuple.t2((0, tea_cup_core_1.just)(react_1.default.createElement(_16_1.default, null)), label);
                }
            }
        };
        const x = iconAndLabel();
        return (react_1.default.createElement("span", { className: "menu-item" },
            react_1.default.createElement("span", { className: "item-icon" }, x.a.withDefaultSupply(() => (react_1.default.createElement(react_1.default.Fragment, null)))),
            react_1.default.createElement("span", null, x.b)));
    });
}
exports.contextMenuRenderer = contextMenuRenderer;
function getItemLabel(proposal) {
    switch (proposal.tag) {
        case 'jv-number':
            return proposal.value.toString();
        case 'jv-string':
            return proposal.value;
        case 'jv-boolean':
            return '' + proposal.value;
        case 'jv-object':
            const props = proposal.properties.map((p) => p.name).join(', ');
            return '{ ' + props + ' }';
        default:
            return (0, JsonValue_1.valueType)(proposal);
    }
}
function typeIcon(t) {
    switch (t) {
        case 'array':
            return (0, tea_cup_core_1.just)(react_1.default.createElement(_16_12.default, null));
        case 'boolean':
            return (0, tea_cup_core_1.just)(react_1.default.createElement(_16_5.default, null));
        case 'null':
            return (0, tea_cup_core_1.just)(react_1.default.createElement(_16_9.default, null));
        case 'number':
            return (0, tea_cup_core_1.just)(react_1.default.createElement(_16_10.default, null));
        case 'object':
            return (0, tea_cup_core_1.just)(react_1.default.createElement(_16_7.default, null));
        case 'string':
            return (0, tea_cup_core_1.just)(react_1.default.createElement(_16_11.default, null));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29udGV4dE1lbnVSZW5kZXJlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9Db250ZXh0TWVudVJlbmRlcmVyLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7O0dBY0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUgsa0RBQW9DO0FBRXBDLGtEQUEwQjtBQUMxQiwyQ0FBa0U7QUFDbEUsK0NBQWtEO0FBQ2xELHlFQUFtRDtBQUNuRCxpRkFBaUU7QUFDakUsNEVBQXlEO0FBQ3pELCtFQUE2RDtBQUM3RCx1RkFBNkU7QUFDN0UsMkVBQXVEO0FBQ3ZELG1GQUFzRTtBQUN0RSxnRkFBZ0U7QUFDaEUsbUZBQXNFO0FBQ3RFLHFGQUF3RTtBQUN4RSxrRkFBa0U7QUFDbEUsNEVBQXVEO0FBQ3ZELDRFQUF1RDtBQUd2RCxTQUFnQixtQkFBbUIsQ0FDakMsQ0FBWTtJQUVaLE9BQU8sR0FBRyxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7UUFDbkMsTUFBTSxZQUFZLEdBQTZDLEdBQUcsRUFBRTtZQUNsRSxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUU7Z0JBQ2IsS0FBSyxNQUFNLENBQUMsQ0FBQztvQkFDWCxPQUFPLG9CQUFLLENBQUMsRUFBRSxDQUFDLElBQUEsbUJBQUksRUFBQyw4QkFBQyxhQUFRLE9BQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7aUJBQzVEO2dCQUNELEtBQUssU0FBUyxDQUFDLENBQUM7b0JBQ2QsT0FBTyxvQkFBSyxDQUFDLEVBQUUsQ0FBQyxJQUFBLG1CQUFJLEVBQUMsOEJBQUMsYUFBUyxPQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDO2lCQUMvRDtnQkFDRCxLQUFLLFdBQVcsQ0FBQyxDQUFDO29CQUNoQixPQUFPLG9CQUFLLENBQUMsRUFBRSxDQUFDLElBQUEsbUJBQUksRUFBQyw4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LENBQUM7QUFFRCxTQUFTLFFBQVEsQ0FBQyxDQUFnQjtJQUNoQyxRQUFRLENBQUMsRUFBRTtRQUNULEtBQUssT0FBTztZQUNWLE9BQU8sSUFBQSxtQkFBSSxFQUFDLDhCQUFDLGNBQU8sT0FBRyxDQUFDLENBQUM7UUFDM0IsS0FBSyxTQUFTO1lBQ1osT0FBTyxJQUFBLG1CQUFJLEVBQUMsOEJBQUMsYUFBaUIsT0FBRyxDQUFDLENBQUM7UUFDckMsS0FBSyxNQUFNO1lBQ1QsT0FBTyxJQUFBLG1CQUFJLEVBQUMsOEJBQUMsYUFBYyxPQUFHLENBQUMsQ0FBQztRQUNsQyxLQUFLLFFBQVE7WUFDWCxPQUFPLElBQUEsbUJBQUksRUFBQyw4QkFBQyxjQUFlLE9BQUcsQ0FBQyxDQUFDO1FBQ25DLEtBQUssUUFBUTtZQUNYLE9BQU8sSUFBQSxtQkFBSSxFQUFDLDhCQUFDLGFBQWMsT0FBRyxDQUFDLENBQUM7UUFDbEMsS0FBSyxRQUFRO1lBQ1gsT0FBTyxJQUFBLG1CQUFJLEVBQUMsOEJBQUMsY0FBWSxPQUFHLENBQUMsQ0FBQztLQUNqQztBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIERpZXNlbCBBdXRob3JzXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCAqIGFzIFRQTSBmcm9tICd0ZWEtcG9wLW1lbnUnO1xuaW1wb3J0IHsgTWVudUFjdGlvbiB9IGZyb20gJy4vQ29udGV4dE1lbnVBY3Rpb25zJztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBKc29uVmFsdWUsIEpzb25WYWx1ZVR5cGUsIHZhbHVlVHlwZSB9IGZyb20gJy4vSnNvblZhbHVlJztcbmltcG9ydCB7IGp1c3QsIE1heWJlLCBUdXBsZSB9IGZyb20gJ3RlYS1jdXAtY29yZSc7XG5pbXBvcnQgQWRkMTYgZnJvbSAnQGNhcmJvbi9pY29ucy1yZWFjdC9saWIvYWRkLzE2JztcbmltcG9ydCBBcnJvd0Rvd24xNiBmcm9tICdAY2FyYm9uL2ljb25zLXJlYWN0L2xpYi9hcnJvdy0tZG93bi8xNic7XG5pbXBvcnQgQXJyb3dzMTYgZnJvbSAnQGNhcmJvbi9pY29ucy1yZWFjdC9saWIvYXJyb3dzLzE2JztcbmltcG9ydCBBcnJvd1VwMTYgZnJvbSAnQGNhcmJvbi9pY29ucy1yZWFjdC9saWIvYXJyb3ctLXVwLzE2JztcbmltcG9ydCBDaGVja2JveENoZWNrZWQxNiBmcm9tICdAY2FyYm9uL2ljb25zLXJlYWN0L2xpYi9jaGVja2JveC0tY2hlY2tlZC8xNic7XG5pbXBvcnQgQ2xvc2UxNiBmcm9tICdAY2FyYm9uL2ljb25zLXJlYWN0L2xpYi9jbG9zZS8xNic7XG5pbXBvcnQgRGVjaXNpb25UcmVlMTYgZnJvbSAnQGNhcmJvbi9pY29ucy1yZWFjdC9saWIvZGVjaXNpb24tdHJlZS8xNic7XG5pbXBvcnQgTWFnaWNXYW5kMTYgZnJvbSAnQGNhcmJvbi9pY29ucy1yZWFjdC9saWIvbWFnaWMtd2FuZC8xNic7XG5pbXBvcnQgTm90QXZhaWxhYmxlMTYgZnJvbSAnQGNhcmJvbi9pY29ucy1yZWFjdC9saWIvbm90LWF2YWlsYWJsZS8xNic7XG5pbXBvcnQgU3RyaW5nSW50ZWdlcjE2IGZyb20gJ0BjYXJib24vaWNvbnMtcmVhY3QvbGliL3N0cmluZy1pbnRlZ2VyLzE2JztcbmltcG9ydCBTdHJpbmdUZXh0MTYgZnJvbSAnQGNhcmJvbi9pY29ucy1yZWFjdC9saWIvc3RyaW5nLXRleHQvMTYnO1xuaW1wb3J0IFRhYmxlMTYgZnJvbSAnQGNhcmJvbi9pY29ucy1yZWFjdC9saWIvdGFibGUvMTYnO1xuaW1wb3J0IFR5cGVzMTYgZnJvbSAnQGNhcmJvbi9pY29ucy1yZWFjdC9saWIvdHlwZXMvMTYnO1xuaW1wb3J0IHsgVEZ1bmN0aW9uIH0gZnJvbSAnaTE4bmV4dCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBjb250ZXh0TWVudVJlbmRlcmVyKFxuICB0OiBURnVuY3Rpb24sXG4pOiBUUE0uSXRlbVJlbmRlcmVyPE1lbnVBY3Rpb24+IHtcbiAgcmV0dXJuIFRQTS5kZWZhdWx0SXRlbVJlbmRlcmVyKChhKSA9PiB7XG4gICAgY29uc3QgaWNvbkFuZExhYmVsOiAoKSA9PiBUdXBsZTxNYXliZTxSZWFjdC5SZWFjdE5vZGU+LCBhbnk+ID0gKCkgPT4ge1xuICAgICAgc3dpdGNoIChhLnRhZykge1xuICAgICAgICBjYXNlICdtb3ZlJzoge1xuICAgICAgICAgIHJldHVybiBUdXBsZS50MihqdXN0KDxBcnJvd3MxNiAvPiksIHQoJ2NvbnRleHRNZW51Lm1vdmUnKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnbW92ZS11cCc6IHtcbiAgICAgICAgICByZXR1cm4gVHVwbGUudDIoanVzdCg8QXJyb3dVcDE2IC8+KSwgdCgnY29udGV4dE1lbnUubW92ZVVwJykpO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ21vdmUtZG93bic6IHtcbiAgICAgICAgICByZXR1cm4gVHVwbGUudDIoanVzdCg8QXJyb3dEb3duMTYgLz4pLCB0KCdjb250ZXh0TWVudS5tb3ZlRG93bicpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdwcm9wb3NlJzoge1xuICAgICAgICAgIHJldHVybiBUdXBsZS50MihqdXN0KDxNYWdpY1dhbmQxNiAvPiksIHQoJ2NvbnRleHRNZW51LnByb3Bvc2UnKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnZGVsZXRlJzoge1xuICAgICAgICAgIHJldHVybiBUdXBsZS50MihqdXN0KDxDbG9zZTE2IC8+KSwgdCgnY29udGV4dE1lbnUuZGVsZXRlJykpO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ3Byb3Bvc2FsJzoge1xuICAgICAgICAgIHJldHVybiBUdXBsZS50Mih0eXBlSWNvbih2YWx1ZVR5cGUoYS52YWx1ZSkpLCBnZXRJdGVtTGFiZWwoYS52YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ3R5cGVzJzoge1xuICAgICAgICAgIHJldHVybiBUdXBsZS50MihqdXN0KDxUeXBlczE2IC8+KSwgdCgnY29udGV4dE1lbnUuY2hhbmdlVHlwZScpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdjaGFuZ2UtdHlwZSc6IHtcbiAgICAgICAgICBjb25zdCB2dCA9IHZhbHVlVHlwZShhLnZhbHVlKTtcbiAgICAgICAgICByZXR1cm4gVHVwbGUudDIodHlwZUljb24odnQpLCB2dCk7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnYWRkJzoge1xuICAgICAgICAgIGNvbnN0IGxhYmVsID0gYS5pc0FycmF5XG4gICAgICAgICAgICA/IHQoJ2NvbnRleHRNZW51LmFkZEVsZW1lbnQnKVxuICAgICAgICAgICAgOiB0KCdjb250ZXh0TWVudS5hZGRQcm9wZXJ0eScpO1xuICAgICAgICAgIHJldHVybiBUdXBsZS50MihqdXN0KDxBZGQxNiAvPiksIGxhYmVsKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgeCA9IGljb25BbmRMYWJlbCgpO1xuICAgIHJldHVybiAoXG4gICAgICA8c3BhbiBjbGFzc05hbWU9XCJtZW51LWl0ZW1cIj5cbiAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaXRlbS1pY29uXCI+XG4gICAgICAgICAge3guYS53aXRoRGVmYXVsdFN1cHBseSgoKSA9PiAoXG4gICAgICAgICAgICA8PjwvPlxuICAgICAgICAgICkpfVxuICAgICAgICA8L3NwYW4+XG4gICAgICAgIDxzcGFuPnt4LmJ9PC9zcGFuPlxuICAgICAgPC9zcGFuPlxuICAgICk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRJdGVtTGFiZWwocHJvcG9zYWw6IEpzb25WYWx1ZSk6IHN0cmluZyB7XG4gIHN3aXRjaCAocHJvcG9zYWwudGFnKSB7XG4gICAgY2FzZSAnanYtbnVtYmVyJzpcbiAgICAgIHJldHVybiBwcm9wb3NhbC52YWx1ZS50b1N0cmluZygpO1xuICAgIGNhc2UgJ2p2LXN0cmluZyc6XG4gICAgICByZXR1cm4gcHJvcG9zYWwudmFsdWU7XG4gICAgY2FzZSAnanYtYm9vbGVhbic6XG4gICAgICByZXR1cm4gJycgKyBwcm9wb3NhbC52YWx1ZTtcbiAgICBjYXNlICdqdi1vYmplY3QnOlxuICAgICAgY29uc3QgcHJvcHMgPSBwcm9wb3NhbC5wcm9wZXJ0aWVzLm1hcCgocCkgPT4gcC5uYW1lKS5qb2luKCcsICcpO1xuICAgICAgcmV0dXJuICd7ICcgKyBwcm9wcyArICcgfSc7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB2YWx1ZVR5cGUocHJvcG9zYWwpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHR5cGVJY29uKHQ6IEpzb25WYWx1ZVR5cGUpIHtcbiAgc3dpdGNoICh0KSB7XG4gICAgY2FzZSAnYXJyYXknOlxuICAgICAgcmV0dXJuIGp1c3QoPFRhYmxlMTYgLz4pO1xuICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgcmV0dXJuIGp1c3QoPENoZWNrYm94Q2hlY2tlZDE2IC8+KTtcbiAgICBjYXNlICdudWxsJzpcbiAgICAgIHJldHVybiBqdXN0KDxOb3RBdmFpbGFibGUxNiAvPik7XG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgIHJldHVybiBqdXN0KDxTdHJpbmdJbnRlZ2VyMTYgLz4pO1xuICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICByZXR1cm4ganVzdCg8RGVjaXNpb25UcmVlMTYgLz4pO1xuICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICByZXR1cm4ganVzdCg8U3RyaW5nVGV4dDE2IC8+KTtcbiAgfVxufVxuIl19